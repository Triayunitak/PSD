
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Probabilistic Forecasting with sktime &#8212; PSD</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '.venv/Lib/site-packages/docs/source/examples/01b_forecasting_proba';</script>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../../../_static/nita.png" class="logo__image only-light" alt="PSD - Home"/>
    <script>document.write(`<img src="../../../../../../_static/nita.png" class="logo__image only-dark" alt="PSD - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../../../business_understanding.html"><strong>Business Problem</strong></a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../../../data_understanding.html"><strong>Data Understanding</strong></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../data_exploration.html"><strong>Data Exploration</strong></a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../data_preprocessing.html"><strong>PrepocessingData</strong></a></li>






<li class="toctree-l1"><a class="reference internal" href="../../../../../../e_coli.html"><strong>E. coli Protein PCA &amp; ADASYN Implementation</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F.venv/Lib/site-packages/docs/source/examples/01b_forecasting_proba.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../../_sources/.venv/Lib/site-packages/docs/source/examples/01b_forecasting_proba.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Probabilistic Forecasting with sktime</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Probabilistic Forecasting with <code class="docutils literal notranslate"><span class="pre">sktime</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-this-notebook">Overview of this notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-start-probabilistic-forecasting-with-sktime">Quick Start - Probabilistic Forecasting with <code class="docutils literal notranslate"><span class="pre">sktime</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-probabilistic-forecasting">What is probabilistic forecasting?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intuition">Intuition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interface-view">Interface view</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formal-view-endogeneous-one-forecast-time-stamp">Formal view (endogeneous, one forecast time stamp)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#more-formal-details-intuition">More formal details &amp; intuition:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilistic-forecasting-interfaces-in-sktime">Probabilistic forecasting interfaces in <code class="docutils literal notranslate"><span class="pre">sktime</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-interval-interval-predictions"><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> - interval predictions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-quantiles-quantile-forecasts"><code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> - quantile forecasts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-var-variance-forecasts"><code class="docutils literal notranslate"><span class="pre">predict_var</span></code> - variance forecasts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-proba-distribution-forecasts-aka-full-probabilistic-forecasts"><code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> - distribution forecasts aka “full” probabilistic forecasts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-note-on-consistence-of-methods">a note on consistence of methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-probabilistic-forecasts-with-update-predict-stream-workflow">Using probabilistic forecasts with update/predict stream workflow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilistic-forecasting-for-multivariate-and-hierarchical-data">Probabilistic forecasting for multivariate and hierarchical data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics-for-probabilistic-forecasts-and-evaluation">Metrics for probabilistic forecasts and evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-theory">overview - theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics-general-signature-and-averaging">metrics: general signature and averaging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics-interval-vs-quantile-metrics">metrics: interval vs quantile metrics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation-by-backtesting">evaluation by backtesting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-evaluation">Visual Evaluation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-composition-pipelines-tuning-reduction-adding-proba-forecasts-to-any-estimator">Advanced composition: pipelines, tuning, reduction, adding proba forecasts to any estimator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-probabilistic-forecasts-to-non-probabilistic-forecasters">Adding probabilistic forecasts to non-probabilistic forecasters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-and-automl">Tuning and AutoML</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines-with-probabilistic-forecasters">Pipelines with probabilistic forecasters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-y-x-fh-does"><code class="docutils literal notranslate"><span class="pre">fit(y,</span> <span class="pre">X,</span> <span class="pre">fh)</span></code> does:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-sth-x-fh-does"><code class="docutils literal notranslate"><span class="pre">predict_[sth](X,</span> <span class="pre">fh)</span></code> does:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><code class="docutils literal notranslate"><span class="pre">fit(y,</span> <span class="pre">X,</span> <span class="pre">fh)</span></code> does:\</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-quantiles-y-x-fh-does"><code class="docutils literal notranslate"><span class="pre">predict_quantiles(y,</span> <span class="pre">X,</span> <span class="pre">fh)</span></code> does:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-your-own-probabilistic-forecaster">Building your own probabilistic forecaster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-resources">Useful resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="probabilistic-forecasting-with-sktime">
<h1>Probabilistic Forecasting with <code class="docutils literal notranslate"><span class="pre">sktime</span></code><a class="headerlink" href="#probabilistic-forecasting-with-sktime" title="Link to this heading">#</a></h1>
<p>originally presented at <a class="reference external" href="https://github.com/sktime/sktime-tutorial-pydata-berlin-2022">pydata Berlin 2022, see there for video presentation</a></p>
<section id="overview-of-this-notebook">
<h2>Overview of this notebook<a class="headerlink" href="#overview-of-this-notebook" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>quick start - probabilistic forecasting</p></li>
<li><p>disambiguation - types of probabilistic forecasts</p></li>
<li><p>details: probabilistic forecasting interfaces</p></li>
<li><p>metrics for, and evaluation of probabilistic forecasts</p></li>
<li><p>advanced composition: pipelines, tuning, reduction</p></li>
<li><p>extender guide</p></li>
<li><p>contributor credits</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="quick-start-probabilistic-forecasting-with-sktime">
<h2>Quick Start - Probabilistic Forecasting with <code class="docutils literal notranslate"><span class="pre">sktime</span></code><a class="headerlink" href="#quick-start-probabilistic-forecasting-with-sktime" title="Link to this heading">#</a></h2>
<p>… works exactly like the basic forecasting workflow, replace <code class="docutils literal notranslate"><span class="pre">predict</span></code> by a probabilistic method!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>

<span class="c1"># step 1: data specification</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>
<span class="c1"># step 2: specifying forecasting horizon</span>
<span class="n">fh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="c1"># step 3: specifying the forecasting algorithm</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">()</span>
<span class="c1"># step 4: fitting the forecaster</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="c1"># step 5: querying predictions</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>

<span class="c1"># for probabilistic forecasting:</span>
<span class="c1">#   call a probabilistic forecasting method after or instead of step 5</span>
<span class="n">y_pred_int</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span><span class="n">coverage</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">y_pred_int</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>371.535093</td>
      <td>481.554608</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>344.853206</td>
      <td>497.712761</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>324.223996</td>
      <td>508.191104</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>probabilistic forecasting methods in <code class="docutils literal notranslate"><span class="pre">sktime</span></code></strong>:</p>
<ul class="simple">
<li><p>forecast intervals    - <code class="docutils literal notranslate"><span class="pre">predict_interval(fh=None,</span> <span class="pre">X=None,</span> <span class="pre">coverage=0.90)</span></code></p></li>
<li><p>forecast quantiles    - <code class="docutils literal notranslate"><span class="pre">predict_quantiles(fh=None,</span> <span class="pre">X=None,</span> <span class="pre">alpha=[0.05,</span> <span class="pre">0.95])</span></code></p></li>
<li><p>forecast variance     - <code class="docutils literal notranslate"><span class="pre">predict_var(fh=None,</span> <span class="pre">X=None,</span> <span class="pre">cov=False)</span></code></p></li>
<li><p>distribution forecast - <code class="docutils literal notranslate"><span class="pre">predict_proba(fh=None,</span> <span class="pre">X=None,</span> <span class="pre">marginal=True)</span></code></p></li>
</ul>
<p>To check which forecasters in <code class="docutils literal notranslate"><span class="pre">sktime</span></code> support probabilistic forecasting, use the <code class="docutils literal notranslate"><span class="pre">registry.all_estimators</span></code> utility and search for estimators which have the <code class="docutils literal notranslate"><span class="pre">capability:pred_int</span></code> tag (value <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
<p>For composites such as pipelines, a positive tag means that logic is implemented if (some or all) components support it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">all_estimators</span>

<span class="n">all_estimators</span><span class="p">(</span>
    <span class="s2">&quot;forecaster&quot;</span><span class="p">,</span> <span class="n">filter_tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;capability:pred_int&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>object</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ARCH</td>
      <td>&lt;class 'sktime.forecasting.arch._uarch.ARCH'&gt;</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ARIMA</td>
      <td>&lt;class 'sktime.forecasting.arima.ARIMA'&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AutoARIMA</td>
      <td>&lt;class 'sktime.forecasting.arima.AutoARIMA'&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AutoETS</td>
      <td>&lt;class 'sktime.forecasting.ets.AutoETS'&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BATS</td>
      <td>&lt;class 'sktime.forecasting.bats.BATS'&gt;</td>
    </tr>
    <tr>
      <th>5</th>
      <td>BaggingForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._bagging.Ba...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ColumnEnsembleForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._column_ens...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ConformalIntervals</td>
      <td>&lt;class 'sktime.forecasting.conformal.Conformal...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>DirRecTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>DirRecTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>DirectTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>DirectTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Dir...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>DynamicFactor</td>
      <td>&lt;class 'sktime.forecasting.dynamic_factor.Dyna...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>FhPlexForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._fhplex.FhP...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>ForecastX</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.F...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ForecastingGridSearchCV</td>
      <td>&lt;class 'sktime.forecasting.model_selection._tu...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ForecastingPipeline</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.F...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ForecastingRandomizedSearchCV</td>
      <td>&lt;class 'sktime.forecasting.model_selection._tu...</td>
    </tr>
    <tr>
      <th>18</th>
      <td>ForecastingSkoptSearchCV</td>
      <td>&lt;class 'sktime.forecasting.model_selection._tu...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>MultioutputTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Mul...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>MultioutputTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Mul...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>NaiveForecaster</td>
      <td>&lt;class 'sktime.forecasting.naive.NaiveForecast...</td>
    </tr>
    <tr>
      <th>22</th>
      <td>NaiveVariance</td>
      <td>&lt;class 'sktime.forecasting.naive.NaiveVariance'&gt;</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Permute</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.P...</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Prophet</td>
      <td>&lt;class 'sktime.forecasting.fbprophet.Prophet'&gt;</td>
    </tr>
    <tr>
      <th>25</th>
      <td>ProphetPiecewiseLinearTrendForecaster</td>
      <td>&lt;class 'sktime.forecasting.trend._pwl_trend_fo...</td>
    </tr>
    <tr>
      <th>26</th>
      <td>RecursiveTabularRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Rec...</td>
    </tr>
    <tr>
      <th>27</th>
      <td>RecursiveTimeSeriesRegressionForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Rec...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>SARIMAX</td>
      <td>&lt;class 'sktime.forecasting.sarimax.SARIMAX'&gt;</td>
    </tr>
    <tr>
      <th>29</th>
      <td>SquaringResiduals</td>
      <td>&lt;class 'sktime.forecasting.squaring_residuals....</td>
    </tr>
    <tr>
      <th>30</th>
      <td>StatsForecastARCH</td>
      <td>&lt;class 'sktime.forecasting.arch._statsforecast...</td>
    </tr>
    <tr>
      <th>31</th>
      <td>StatsForecastAutoARIMA</td>
      <td>&lt;class 'sktime.forecasting.statsforecast.Stats...</td>
    </tr>
    <tr>
      <th>32</th>
      <td>StatsForecastAutoCES</td>
      <td>&lt;class 'sktime.forecasting.statsforecast.Stats...</td>
    </tr>
    <tr>
      <th>33</th>
      <td>StatsForecastAutoETS</td>
      <td>&lt;class 'sktime.forecasting.statsforecast.Stats...</td>
    </tr>
    <tr>
      <th>34</th>
      <td>StatsForecastAutoTheta</td>
      <td>&lt;class 'sktime.forecasting.statsforecast.Stats...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>StatsForecastGARCH</td>
      <td>&lt;class 'sktime.forecasting.arch._statsforecast...</td>
    </tr>
    <tr>
      <th>36</th>
      <td>StatsForecastMSTL</td>
      <td>&lt;class 'sktime.forecasting.statsforecast.Stats...</td>
    </tr>
    <tr>
      <th>37</th>
      <td>TBATS</td>
      <td>&lt;class 'sktime.forecasting.tbats.TBATS'&gt;</td>
    </tr>
    <tr>
      <th>38</th>
      <td>ThetaForecaster</td>
      <td>&lt;class 'sktime.forecasting.theta.ThetaForecast...</td>
    </tr>
    <tr>
      <th>39</th>
      <td>TransformedTargetForecaster</td>
      <td>&lt;class 'sktime.forecasting.compose._pipeline.T...</td>
    </tr>
    <tr>
      <th>40</th>
      <td>UnobservedComponents</td>
      <td>&lt;class 'sktime.forecasting.structural.Unobserv...</td>
    </tr>
    <tr>
      <th>41</th>
      <td>VAR</td>
      <td>&lt;class 'sktime.forecasting.var.VAR'&gt;</td>
    </tr>
    <tr>
      <th>42</th>
      <td>VECM</td>
      <td>&lt;class 'sktime.forecasting.vecm.VECM'&gt;</td>
    </tr>
    <tr>
      <th>43</th>
      <td>YfromX</td>
      <td>&lt;class 'sktime.forecasting.compose._reduce.Yfr...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
</section>
<section id="what-is-probabilistic-forecasting">
<h2>What is probabilistic forecasting?<a class="headerlink" href="#what-is-probabilistic-forecasting" title="Link to this heading">#</a></h2>
<section id="intuition">
<h3>Intuition<a class="headerlink" href="#intuition" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>produce low/high scenarios of forecasts</p></li>
<li><p>quantify uncertainty around forecasts</p></li>
<li><p>produce expected range of variation of forecasts</p></li>
</ul>
</section>
<section id="interface-view">
<h3>Interface view<a class="headerlink" href="#interface-view" title="Link to this heading">#</a></h3>
<p><strong>Want</strong> to produce “distribution” or “range” of forecast values,</p>
<p>at time stamps defined by <strong>forecasting horizon</strong> <code class="docutils literal notranslate"><span class="pre">fh</span></code></p>
<p>given <strong>past data</strong> <code class="docutils literal notranslate"><span class="pre">y</span></code> (series), and possibly exogeneous data <code class="docutils literal notranslate"><span class="pre">X</span></code></p>
<p>Input, to <code class="docutils literal notranslate"><span class="pre">fit</span></code> or <code class="docutils literal notranslate"><span class="pre">predict</span></code>: <code class="docutils literal notranslate"><span class="pre">fh</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">X</span></code></p>
<p>Output, from <code class="docutils literal notranslate"><span class="pre">predict_probabilistic</span></code>: some “distribution” or “range” object</p>
<p><strong>Big caveat</strong>: there are multiple possible ways to model “distribution” or “range”!</p>
<p>Used in practice and easily confused! (and often, practically, confused!)</p>
</section>
<section id="formal-view-endogeneous-one-forecast-time-stamp">
<h3>Formal view (endogeneous, one forecast time stamp)<a class="headerlink" href="#formal-view-endogeneous-one-forecast-time-stamp" title="Link to this heading">#</a></h3>
<p>Let  <span class="math notranslate nohighlight">\(y(t_1), \dots, y(t_n)\)</span> be observations at fixed time stamps <span class="math notranslate nohighlight">\(t_1, \dots, t_n\)</span>.</p>
<p>(we consider <span class="math notranslate nohighlight">\(y\)</span> as an <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>-valued random variable)</p>
<p>Let <span class="math notranslate nohighlight">\(y'\)</span> be a (true) value, which will be observed at a future time stamp <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
<p>(we consider <span class="math notranslate nohighlight">\(y'\)</span> as an <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>-valued random variable)</p>
<p>We have the following “types of forecasts” of <span class="math notranslate nohighlight">\(y'\)</span>:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>param</p></th>
<th class="head"><p>prediction/estimate of</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">sktime</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>point forecast</p></td>
<td><p></p></td>
<td><p>conditional expectation <span class="math notranslate nohighlight">\(\mathbb{E}[y'|y]\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">predict</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>variance forecast</p></td>
<td><p></p></td>
<td><p>conditional variance <span class="math notranslate nohighlight">\(Var[y'|y]\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">predict_var</span></code></p></td>
</tr>
<tr class="row-even"><td><p>quantile forecast</p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\in (0,1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\)</span>-quantile of <span class="math notranslate nohighlight">\(y'|y\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>interval forecast</p></td>
<td><p><span class="math notranslate nohighlight">\(c\in (0,1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\([a,b]\)</span> s.t. <span class="math notranslate nohighlight">\(P(a\le y' \le b| y) = c\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code></p></td>
</tr>
<tr class="row-even"><td><p>distribution forecast</p></td>
<td><p></p></td>
<td><p>the law/distribution of <span class="math notranslate nohighlight">\(y'|y\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">predict_proba</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Notes:</p>
<ul class="simple">
<li><p>different forecasters have different capabilities!</p></li>
<li><p>metrics, evaluation &amp; tuning are different by “type of forecast”</p></li>
<li><p>compositors can “add” type of forecast! Example: bootstrap</p></li>
</ul>
<section id="more-formal-details-intuition">
<h4>More formal details &amp; intuition:<a class="headerlink" href="#more-formal-details-intuition" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>a <strong>“point forecast”</strong> is a prediction/estimate of the conditional expectation <span class="math notranslate nohighlight">\(\mathbb{E}[y'|y]\)</span>.<br />
<strong>Intuition</strong>: “out of many repetitions/worlds, this value is the arithmetic average of all observations”.</p></li>
<li><p>a <strong>“variance forecast”</strong> is a prediction/estimate of the conditional expectation <span class="math notranslate nohighlight">\(Var[y'|y]\)</span>.<br />
<strong>Intuition:</strong> “out of many repetitions/worlds, this value is the average squared distance of the observation to the perfect point forecast”.</p></li>
<li><p>a <strong>“quantile forecast”</strong>, at quantile point <span class="math notranslate nohighlight">\(\alpha\in (0,1)\)</span> is a prediction/estimate of the <span class="math notranslate nohighlight">\(\alpha\)</span>-quantile of <span class="math notranslate nohighlight">\(y'|y\)</span>, i.e., of <span class="math notranslate nohighlight">\(F^{-1}_{y'|y}(\alpha)\)</span>, where <span class="math notranslate nohighlight">\(F^{-1}\)</span> is the (generalized) inverse cdf = quantile function of the random variable y’|y.<br />
<strong>Intuition</strong>: “out of many repetitions/worlds, a fraction of exactly <span class="math notranslate nohighlight">\(\alpha\)</span> will have equal or smaller than this value.”</p></li>
<li><p>an <strong>“interval forecast”</strong> or “predictive interval” with (symmetric) coverage <span class="math notranslate nohighlight">\(c\in (0,1)\)</span> is a prediction/estimate pair of lower bound <span class="math notranslate nohighlight">\(a\)</span> and upper bound <span class="math notranslate nohighlight">\(b\)</span> such that <span class="math notranslate nohighlight">\(P(a\le y' \le b| y) = c\)</span> and <span class="math notranslate nohighlight">\(P(y' \gneq b| y) = P(y' \lneq a| y) = (1 - c) /2\)</span>.<br />
<strong>Intuition</strong>: “out of many repetitions/worlds, a fraction of exactly <span class="math notranslate nohighlight">\(c\)</span> will be contained in the interval <span class="math notranslate nohighlight">\([a,b]\)</span>, and being above is equally likely as being below”.</p></li>
<li><p>a <strong>“distribution forecast”</strong> or “full probabilistic forecast” is a prediction/estimate of the distribution of <span class="math notranslate nohighlight">\(y'|y\)</span>, e.g., “it’s a normal distribution with mean 42 and variance 1”.<br />
<strong>Intuition</strong>: exhaustive description of the generating mechanism of many repetitions/worlds.</p></li>
</ul>
<p>Notes:</p>
<ul class="simple">
<li><p>lower/upper of interval forecasts are quantile forecasts at quantile points <span class="math notranslate nohighlight">\(0.5 - c/2\)</span> and <span class="math notranslate nohighlight">\(0.5 + c/2\)</span> (as long as forecast distributions are absolutely continuous).</p></li>
<li><p>all other forecasts can be obtained from a full probabilistic forecasts; a full probabilistic forecast can be obtained from all quantile forecasts or all interval forecasts.</p></li>
<li><p>there is no exact relation between the other types of forecasts (point or variance vs quantile)</p></li>
<li><p>in particular, point forecast does not need to be median forecast aka 0.5-quantile forecast. Can be <span class="math notranslate nohighlight">\(\alpha\)</span>-quantile for any <span class="math notranslate nohighlight">\(\alpha\)</span>!</p></li>
</ul>
<p>Frequent confusion in literature &amp; python packages:</p>
<ul class="simple">
<li><p>coverage <code class="docutils literal notranslate"><span class="pre">c</span></code> vs quantile <code class="docutils literal notranslate"><span class="pre">\alpha</span></code></p></li>
<li><p>coverage <code class="docutils literal notranslate"><span class="pre">c</span></code> vs significance <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">=</span> <span class="pre">1-c</span></code></p></li>
<li><p>quantile of lower interval bound, <code class="docutils literal notranslate"><span class="pre">p/2</span></code>, vs <code class="docutils literal notranslate"><span class="pre">p</span></code></p></li>
<li><p>interval forecasts vs related, but substantially different concepts: confidence interval on predictive mean; Bayesian posterior or credibility interval of the predictive mean</p></li>
<li><p>all forecasts above can be Bayesian, confusion: “posteriors are different” or “have to be evaluated differently”</p></li>
</ul>
<hr class="docutils" />
</section>
</section>
</section>
<section id="probabilistic-forecasting-interfaces-in-sktime">
<h2>Probabilistic forecasting interfaces in <code class="docutils literal notranslate"><span class="pre">sktime</span></code><a class="headerlink" href="#probabilistic-forecasting-interfaces-in-sktime" title="Link to this heading">#</a></h2>
<p>This section:</p>
<ul class="simple">
<li><p>walkthrough of probabilistic predict methods</p></li>
<li><p>use in update/predict workflow</p></li>
<li><p>multivariate and hierarchical data</p></li>
</ul>
<p>All forecasters with tag <code class="docutils literal notranslate"><span class="pre">capability:pred_int</span></code> provide the following:</p>
<ul class="simple">
<li><p>forecast intervals    - <code class="docutils literal notranslate"><span class="pre">predict_interval(fh=None,</span> <span class="pre">X=None,</span> <span class="pre">coverage=0.90)</span></code></p></li>
<li><p>forecast quantiles    - <code class="docutils literal notranslate"><span class="pre">predict_quantiles(fh=None,</span> <span class="pre">X=None,</span> <span class="pre">alpha=[0.05,</span> <span class="pre">0.95])</span></code></p></li>
<li><p>forecast variance     - <code class="docutils literal notranslate"><span class="pre">predict_var(fh=None,</span> <span class="pre">X=None,</span> <span class="pre">cov=False)</span></code></p></li>
<li><p>distribution forecast - <code class="docutils literal notranslate"><span class="pre">predict_proba(fh=None,</span> <span class="pre">X=None,</span> <span class="pre">marginal=True)</span></code></p></li>
</ul>
<p>Generalities:</p>
<ul class="simple">
<li><p>methods do not change state, multiple can be called</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fh</span></code> is optional, if passed late</p></li>
<li><p>exogeneous data <code class="docutils literal notranslate"><span class="pre">X</span></code> can be passed</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.theta</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThetaForecaster</span>

<span class="c1"># until fit, identical with the simple workflow</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>

<span class="n">fh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">ThetaForecaster</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-004057fc-ae13-4279-8d60-068489238f5d {color: black;background-color: white;}#sk-004057fc-ae13-4279-8d60-068489238f5d pre{padding: 0;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-toggleable {background-color: white;}#sk-004057fc-ae13-4279-8d60-068489238f5d label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-004057fc-ae13-4279-8d60-068489238f5d label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-004057fc-ae13-4279-8d60-068489238f5d label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-004057fc-ae13-4279-8d60-068489238f5d input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-004057fc-ae13-4279-8d60-068489238f5d input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-004057fc-ae13-4279-8d60-068489238f5d input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-estimator:hover {background-color: #d4ebff;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-item {z-index: 1;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-parallel-item:only-child::after {width: 0;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-004057fc-ae13-4279-8d60-068489238f5d div.sk-text-repr-fallback {display: none;}</style><div id='sk-004057fc-ae13-4279-8d60-068489238f5d' class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ThetaForecaster(sp=12)</pre><b>Please rerun this cell to show the HTML repr or trust the notebook.</b></div><div class="sk-container" hidden><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('cf35510d-eede-412b-a436-ade6e217eb7b') type="checkbox" checked><label for=UUID('cf35510d-eede-412b-a436-ade6e217eb7b') class='sk-toggleable__label sk-toggleable__label-arrow'>ThetaForecaster</label><div class="sk-toggleable__content"><pre>ThetaForecaster(sp=12)</pre></div></div></div></div></div></div></div>
</div>
<section id="predict-interval-interval-predictions">
<h3><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> - interval predictions<a class="headerlink" href="#predict-interval-interval-predictions" title="Link to this heading">#</a></h3>
<p>Inputs:<br />
<code class="docutils literal notranslate"><span class="pre">fh</span></code> - forecasting horizon (not necessary if seen in <code class="docutils literal notranslate"><span class="pre">fit</span></code>)<br />
<code class="docutils literal notranslate"><span class="pre">coverage</span></code>, float or list of floats, default=<code class="docutils literal notranslate"><span class="pre">0.9</span></code><br />
nominal coverage(s) of the prediction interval(s) queried</p>
<p>Output: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code><br />
Row index is <code class="docutils literal notranslate"><span class="pre">fh</span></code><br />
Column has multi-index:<br />
1st level = variable name from y in fit<br />
2nd level = coverage fractions in <code class="docutils literal notranslate"><span class="pre">coverage</span></code><br />
3rd level = string “lower” or “upper”\</p>
<p>Entries = forecasts of lower/upper interval at nominal coverage in 2nd lvl, for var in 1st lvl, for time in row</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coverage</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">y_pred_ints</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span><span class="n">coverage</span><span class="o">=</span><span class="n">coverage</span><span class="p">)</span>
<span class="n">y_pred_ints</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>418.280172</td>
      <td>464.281948</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>402.215949</td>
      <td>456.888033</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>459.966199</td>
      <td>522.110467</td>
    </tr>
    <tr>
      <th>1961-04</th>
      <td>442.589406</td>
      <td>511.399168</td>
    </tr>
    <tr>
      <th>1961-05</th>
      <td>443.525135</td>
      <td>518.409423</td>
    </tr>
    <tr>
      <th>1961-06</th>
      <td>506.585936</td>
      <td>587.087674</td>
    </tr>
    <tr>
      <th>1961-07</th>
      <td>561.496901</td>
      <td>647.248887</td>
    </tr>
    <tr>
      <th>1961-08</th>
      <td>557.363463</td>
      <td>648.062286</td>
    </tr>
    <tr>
      <th>1961-09</th>
      <td>477.658200</td>
      <td>573.047663</td>
    </tr>
    <tr>
      <th>1961-10</th>
      <td>407.915238</td>
      <td>507.775255</td>
    </tr>
    <tr>
      <th>1961-11</th>
      <td>346.943075</td>
      <td>451.081907</td>
    </tr>
    <tr>
      <th>1961-12</th>
      <td>394.708381</td>
      <td>502.957028</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>pretty-plotting the predictive interval forecasts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">plotting</span>

<span class="c1"># also requires predictions</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_series</span><span class="p">(</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">],</span> <span class="n">pred_interval</span><span class="o">=</span><span class="n">y_pred_ints</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/7d98fc447e5f336ce93c5132136c83f525a9050131b9afaba5923eb9fa9a72d9.png" src="../../../../../../_images/7d98fc447e5f336ce93c5132136c83f525a9050131b9afaba5923eb9fa9a72d9.png" />
</div>
</div>
<p>multiple coverages:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coverage</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]</span>
<span class="n">y_pred_ints</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span><span class="n">coverage</span><span class="o">=</span><span class="n">coverage</span><span class="p">)</span>
<span class="n">y_pred_ints</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.50</th>
      <th colspan="2" halign="left">0.90</th>
      <th colspan="2" halign="left">0.95</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
      <th>lower</th>
      <th>upper</th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>431.849301</td>
      <td>450.712819</td>
      <td>418.280172</td>
      <td>464.281948</td>
      <td>413.873811</td>
      <td>468.688309</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>418.342556</td>
      <td>440.761426</td>
      <td>402.215949</td>
      <td>456.888033</td>
      <td>396.979088</td>
      <td>462.124894</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>478.296873</td>
      <td>503.779792</td>
      <td>459.966199</td>
      <td>522.110467</td>
      <td>454.013601</td>
      <td>528.063064</td>
    </tr>
    <tr>
      <th>1961-04</th>
      <td>462.886199</td>
      <td>491.102375</td>
      <td>442.589406</td>
      <td>511.399168</td>
      <td>435.998343</td>
      <td>517.990231</td>
    </tr>
    <tr>
      <th>1961-05</th>
      <td>465.613729</td>
      <td>496.320829</td>
      <td>443.525135</td>
      <td>518.409423</td>
      <td>436.352213</td>
      <td>525.582346</td>
    </tr>
    <tr>
      <th>1961-06</th>
      <td>530.331507</td>
      <td>563.342102</td>
      <td>506.585936</td>
      <td>587.087674</td>
      <td>498.874936</td>
      <td>594.798674</td>
    </tr>
    <tr>
      <th>1961-07</th>
      <td>586.791137</td>
      <td>621.954652</td>
      <td>561.496901</td>
      <td>647.248887</td>
      <td>553.282997</td>
      <td>655.462791</td>
    </tr>
    <tr>
      <th>1961-08</th>
      <td>584.116865</td>
      <td>621.308884</td>
      <td>557.363463</td>
      <td>648.062286</td>
      <td>548.675718</td>
      <td>656.750031</td>
    </tr>
    <tr>
      <th>1961-09</th>
      <td>505.795199</td>
      <td>544.910664</td>
      <td>477.658200</td>
      <td>573.047663</td>
      <td>468.521153</td>
      <td>582.184710</td>
    </tr>
    <tr>
      <th>1961-10</th>
      <td>437.370915</td>
      <td>478.319578</td>
      <td>407.915238</td>
      <td>507.775255</td>
      <td>398.349972</td>
      <td>517.340521</td>
    </tr>
    <tr>
      <th>1961-11</th>
      <td>377.660872</td>
      <td>420.364110</td>
      <td>346.943075</td>
      <td>451.081907</td>
      <td>336.967955</td>
      <td>461.057027</td>
    </tr>
    <tr>
      <th>1961-12</th>
      <td>426.638449</td>
      <td>471.026960</td>
      <td>394.708381</td>
      <td>502.957028</td>
      <td>384.339595</td>
      <td>513.325814</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="predict-quantiles-quantile-forecasts">
<h3><code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> - quantile forecasts<a class="headerlink" href="#predict-quantiles-quantile-forecasts" title="Link to this heading">#</a></h3>
<p>Inputs:<br />
<code class="docutils literal notranslate"><span class="pre">fh</span></code> - forecasting horizon (not necessary if seen in <code class="docutils literal notranslate"><span class="pre">fit</span></code>)<br />
<code class="docutils literal notranslate"><span class="pre">alpha</span></code>, float or list of floats, default = <code class="docutils literal notranslate"><span class="pre">[0.1,</span> <span class="pre">0.9]</span></code><br />
quantile points at which quantiles are queried</p>
<p>Output: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code><br />
Row index is <code class="docutils literal notranslate"><span class="pre">fh</span></code><br />
Column has multi-index:<br />
1st level = variable name from y in fit<br />
2nd level = quantile points in <code class="docutils literal notranslate"><span class="pre">alpha</span></code>\</p>
<p>Entries = forecasts of quantiles at quantile point in 2nd lvl, for var in 1st lvl, for time in row</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="n">y_pred_quantiles</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_quantiles</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">y_pred_quantiles</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="5" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th>0.10</th>
      <th>0.25</th>
      <th>0.50</th>
      <th>0.75</th>
      <th>0.90</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>423.360423</td>
      <td>431.849301</td>
      <td>441.281060</td>
      <td>450.712819</td>
      <td>459.201697</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>408.253714</td>
      <td>418.342556</td>
      <td>429.551991</td>
      <td>440.761426</td>
      <td>450.850267</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>466.829162</td>
      <td>478.296873</td>
      <td>491.038333</td>
      <td>503.779792</td>
      <td>515.247503</td>
    </tr>
    <tr>
      <th>1961-04</th>
      <td>450.188480</td>
      <td>462.886199</td>
      <td>476.994287</td>
      <td>491.102375</td>
      <td>503.800094</td>
    </tr>
    <tr>
      <th>1961-05</th>
      <td>451.795055</td>
      <td>465.613729</td>
      <td>480.967279</td>
      <td>496.320829</td>
      <td>510.139503</td>
    </tr>
    <tr>
      <th>1961-06</th>
      <td>515.476224</td>
      <td>530.331507</td>
      <td>546.836805</td>
      <td>563.342102</td>
      <td>578.197385</td>
    </tr>
    <tr>
      <th>1961-07</th>
      <td>570.967006</td>
      <td>586.791137</td>
      <td>604.372894</td>
      <td>621.954652</td>
      <td>637.778782</td>
    </tr>
    <tr>
      <th>1961-08</th>
      <td>567.379877</td>
      <td>584.116865</td>
      <td>602.712875</td>
      <td>621.308884</td>
      <td>638.045872</td>
    </tr>
    <tr>
      <th>1961-09</th>
      <td>488.192629</td>
      <td>505.795199</td>
      <td>525.352932</td>
      <td>544.910664</td>
      <td>562.513234</td>
    </tr>
    <tr>
      <th>1961-10</th>
      <td>418.943377</td>
      <td>437.370915</td>
      <td>457.845247</td>
      <td>478.319578</td>
      <td>496.747116</td>
    </tr>
    <tr>
      <th>1961-11</th>
      <td>358.443750</td>
      <td>377.660872</td>
      <td>399.012491</td>
      <td>420.364110</td>
      <td>439.581232</td>
    </tr>
    <tr>
      <th>1961-12</th>
      <td>406.662927</td>
      <td>426.638449</td>
      <td>448.832705</td>
      <td>471.026960</td>
      <td>491.002482</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>pretty-plotting the quantile interval forecasts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">plotting</span>

<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_pred_quantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y_pred_quantiles</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">plot_series</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="o">*</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/04fae7e879653d018b0fd44955552e6d6e9b884581baee55edb26642a12057b7.png" src="../../../../../../_images/04fae7e879653d018b0fd44955552e6d6e9b884581baee55edb26642a12057b7.png" />
</div>
</div>
</section>
<section id="predict-var-variance-forecasts">
<h3><code class="docutils literal notranslate"><span class="pre">predict_var</span></code> - variance forecasts<a class="headerlink" href="#predict-var-variance-forecasts" title="Link to this heading">#</a></h3>
<p>Inputs:<br />
<code class="docutils literal notranslate"><span class="pre">fh</span></code> - forecasting horizon (not necessary if seen in <code class="docutils literal notranslate"><span class="pre">fit</span></code>)<br />
<code class="docutils literal notranslate"><span class="pre">cov</span></code>, boolean, default=False<br />
whether covariance forecasts should also be returned (not all estimators support this)</p>
<p>Output: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, for cov=False:<br />
Row index is <code class="docutils literal notranslate"><span class="pre">fh</span></code><br />
Column is equal to column index of <code class="docutils literal notranslate"><span class="pre">y</span></code> (variables)</p>
<p>Entries = variance forecast for variable in col, for time in row</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_variance</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_var</span><span class="p">()</span>
<span class="n">y_pred_variance</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Number of airline passengers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>195.539593</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>276.195596</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>356.851599</td>
    </tr>
    <tr>
      <th>1961-04</th>
      <td>437.507602</td>
    </tr>
    <tr>
      <th>1961-05</th>
      <td>518.163605</td>
    </tr>
    <tr>
      <th>1961-06</th>
      <td>598.819609</td>
    </tr>
    <tr>
      <th>1961-07</th>
      <td>679.475612</td>
    </tr>
    <tr>
      <th>1961-08</th>
      <td>760.131615</td>
    </tr>
    <tr>
      <th>1961-09</th>
      <td>840.787618</td>
    </tr>
    <tr>
      <th>1961-10</th>
      <td>921.443621</td>
    </tr>
    <tr>
      <th>1961-11</th>
      <td>1002.099625</td>
    </tr>
    <tr>
      <th>1961-12</th>
      <td>1082.755628</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>with covariance, using a forecaster which can return covariance forecasts:</p>
<p>return is <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with <code class="docutils literal notranslate"><span class="pre">fh</span></code> indexing rows and columns;<br />
entries are forecast covariance between row and column time<br />
(diagonal = forecast variances)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveVariance</span>

<span class="n">forecaster_with_covariance</span> <span class="o">=</span> <span class="n">NaiveVariance</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span>
<span class="n">forecaster_with_covariance</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>
<span class="n">forecaster_with_covariance</span><span class="o">.</span><span class="n">predict_var</span><span class="p">(</span><span class="n">cov</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1961-01</th>
      <th>1961-02</th>
      <th>1961-03</th>
      <th>1961-04</th>
      <th>1961-05</th>
      <th>1961-06</th>
      <th>1961-07</th>
      <th>1961-08</th>
      <th>1961-09</th>
      <th>1961-10</th>
      <th>1961-11</th>
      <th>1961-12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>292.337471</td>
      <td>255.743135</td>
      <td>264.805619</td>
      <td>227.703299</td>
      <td>146.093963</td>
      <td>154.453017</td>
      <td>157.976941</td>
      <td>105.160905</td>
      <td>78.330325</td>
      <td>81.835863</td>
      <td>78.048901</td>
      <td>197.364557</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>255.743135</td>
      <td>422.704744</td>
      <td>402.539434</td>
      <td>353.437296</td>
      <td>291.205527</td>
      <td>236.588093</td>
      <td>227.199554</td>
      <td>205.653167</td>
      <td>152.067485</td>
      <td>121.629181</td>
      <td>156.199120</td>
      <td>245.437948</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>264.805619</td>
      <td>402.539434</td>
      <td>588.085546</td>
      <td>506.095737</td>
      <td>426.997658</td>
      <td>394.504152</td>
      <td>311.458024</td>
      <td>282.072322</td>
      <td>243.688649</td>
      <td>185.938879</td>
      <td>185.070366</td>
      <td>305.461239</td>
    </tr>
    <tr>
      <th>1961-04</th>
      <td>227.703299</td>
      <td>353.437296</td>
      <td>506.095737</td>
      <td>634.350765</td>
      <td>526.181098</td>
      <td>482.653409</td>
      <td>422.777588</td>
      <td>323.454003</td>
      <td>280.749435</td>
      <td>242.065886</td>
      <td>211.397247</td>
      <td>294.971131</td>
    </tr>
    <tr>
      <th>1961-05</th>
      <td>146.093963</td>
      <td>291.205527</td>
      <td>426.997658</td>
      <td>526.181098</td>
      <td>628.659434</td>
      <td>570.277703</td>
      <td>499.460344</td>
      <td>419.166586</td>
      <td>325.582827</td>
      <td>281.608648</td>
      <td>269.847466</td>
      <td>318.534732</td>
    </tr>
    <tr>
      <th>1961-06</th>
      <td>154.453017</td>
      <td>236.588093</td>
      <td>394.504152</td>
      <td>482.653409</td>
      <td>570.277703</td>
      <td>728.132786</td>
      <td>629.185105</td>
      <td>527.767275</td>
      <td>444.690652</td>
      <td>330.643779</td>
      <td>313.248539</td>
      <td>382.803374</td>
    </tr>
    <tr>
      <th>1961-07</th>
      <td>157.976941</td>
      <td>227.199554</td>
      <td>311.458024</td>
      <td>422.777588</td>
      <td>499.460344</td>
      <td>629.185105</td>
      <td>753.550246</td>
      <td>629.138943</td>
      <td>536.407703</td>
      <td>441.998734</td>
      <td>352.571074</td>
      <td>415.111062</td>
    </tr>
    <tr>
      <th>1961-08</th>
      <td>105.160905</td>
      <td>205.653167</td>
      <td>282.072322</td>
      <td>323.454003</td>
      <td>419.166586</td>
      <td>527.767275</td>
      <td>629.138943</td>
      <td>729.423502</td>
      <td>615.142609</td>
      <td>506.155725</td>
      <td>439.994913</td>
      <td>430.992397</td>
    </tr>
    <tr>
      <th>1961-09</th>
      <td>78.330325</td>
      <td>152.067485</td>
      <td>243.688649</td>
      <td>280.749435</td>
      <td>325.582827</td>
      <td>444.690652</td>
      <td>536.407703</td>
      <td>615.142609</td>
      <td>744.225693</td>
      <td>609.227267</td>
      <td>527.489655</td>
      <td>546.637686</td>
    </tr>
    <tr>
      <th>1961-10</th>
      <td>81.835863</td>
      <td>121.629181</td>
      <td>185.938879</td>
      <td>242.065886</td>
      <td>281.608648</td>
      <td>330.643779</td>
      <td>441.998734</td>
      <td>506.155725</td>
      <td>609.227267</td>
      <td>697.805589</td>
      <td>590.542100</td>
      <td>604.681197</td>
    </tr>
    <tr>
      <th>1961-11</th>
      <td>78.048901</td>
      <td>156.199120</td>
      <td>185.070366</td>
      <td>211.397247</td>
      <td>269.847466</td>
      <td>313.248539</td>
      <td>352.571074</td>
      <td>439.994913</td>
      <td>527.489655</td>
      <td>590.542100</td>
      <td>706.960650</td>
      <td>698.982624</td>
    </tr>
    <tr>
      <th>1961-12</th>
      <td>197.364557</td>
      <td>245.437948</td>
      <td>305.461239</td>
      <td>294.971131</td>
      <td>318.534732</td>
      <td>382.803374</td>
      <td>415.111062</td>
      <td>430.992397</td>
      <td>546.637686</td>
      <td>604.681197</td>
      <td>698.982624</td>
      <td>913.698290</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="predict-proba-distribution-forecasts-aka-full-probabilistic-forecasts">
<h3><code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> - distribution forecasts aka “full” probabilistic forecasts<a class="headerlink" href="#predict-proba-distribution-forecasts-aka-full-probabilistic-forecasts" title="Link to this heading">#</a></h3>
<p>Inputs:<br />
<code class="docutils literal notranslate"><span class="pre">fh</span></code> - forecasting horizon (not necessary if seen in <code class="docutils literal notranslate"><span class="pre">fit</span></code>)<br />
<code class="docutils literal notranslate"><span class="pre">marginal</span></code>, bool, optional, default=True<br />
whether returned distribution is marginal over time points (True), or joint over time points (False)<br />
(not all forecasters support <code class="docutils literal notranslate"><span class="pre">marginal=False</span></code>)</p>
<p>Output: <code class="docutils literal notranslate"><span class="pre">tensorflow-probability</span></code> <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> object (requires <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> installed)<br />
if <code class="docutils literal notranslate"><span class="pre">marginal=True</span></code>: batch shape 1D, <code class="docutils literal notranslate"><span class="pre">len(fh)</span></code> (time); event shape 1D, <code class="docutils literal notranslate"><span class="pre">len(y.columns)</span></code> (variables)<br />
if <code class="docutils literal notranslate"><span class="pre">marginal=False</span></code>: event shape 2D, <code class="docutils literal notranslate"><span class="pre">[len(fh),</span> <span class="pre">len(y.columns)]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_dist</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">()</span>
<span class="n">y_pred_dist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f {color: black;background-color: white;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f pre{padding: 0;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-toggleable {background-color: white;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-estimator:hover {background-color: #d4ebff;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-item {z-index: 1;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-parallel-item:only-child::after {width: 0;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f div.sk-text-repr-fallback {display: none;}</style><div id='sk-70a3e71e-7ccd-45fb-bff5-d09c673cf22f' class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Normal(columns=Index([&#x27;Number of airline passengers&#x27;], dtype=&#x27;object&#x27;),
       index=PeriodIndex([&#x27;1961-01&#x27;, &#x27;1961-02&#x27;, &#x27;1961-03&#x27;, &#x27;1961-04&#x27;, &#x27;1961-05&#x27;, &#x27;1961-06&#x27;,
             &#x27;1961-07&#x27;, &#x27;1961-08&#x27;, &#x27;1961-09&#x27;, &#x27;1961-10&#x27;, &#x27;1961-11&#x27;, &#x27;1961-12&#x27;],
            dtype=&#x27;period[M]&#x27;),
       mu=         Number of airline passengers
1961-01                    441.281060
1961-02                    429.551991
1961-03                    491.038333
1961-04                    476.994287
1961-05                    480.967279
1961-06                    546.836805
1961-07                    604.372894
1961-08                    602.712875
1961-09                    525.352932
1961-10                    457.845247
1961-11                    399.012491
1961-12                    448.832705,
       sigma=         Number of airline passengers
1961-01                     13.983547
1961-02                     16.619133
1961-03                     18.890516
1961-04                     20.916682
1961-05                     22.763207
1961-06                     24.470791
1961-07                     26.066753
1961-08                     27.570484
1961-09                     28.996338
1961-10                     30.355290
1961-11                     31.655957
1961-12                     32.905252)</pre><b>Please rerun this cell to show the HTML repr or trust the notebook.</b></div><div class="sk-container" hidden><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('a3a1ebd0-1a1f-4de3-8ea5-bd64e2725298') type="checkbox" checked><label for=UUID('a3a1ebd0-1a1f-4de3-8ea5-bd64e2725298') class='sk-toggleable__label sk-toggleable__label-arrow'>Normal</label><div class="sk-toggleable__content"><pre>Normal(columns=Index([&#x27;Number of airline passengers&#x27;], dtype=&#x27;object&#x27;),
       index=PeriodIndex([&#x27;1961-01&#x27;, &#x27;1961-02&#x27;, &#x27;1961-03&#x27;, &#x27;1961-04&#x27;, &#x27;1961-05&#x27;, &#x27;1961-06&#x27;,
             &#x27;1961-07&#x27;, &#x27;1961-08&#x27;, &#x27;1961-09&#x27;, &#x27;1961-10&#x27;, &#x27;1961-11&#x27;, &#x27;1961-12&#x27;],
            dtype=&#x27;period[M]&#x27;),
       mu=         Number of airline passengers
1961-01                    441.281060
1961-02                    429.551991
1961-03                    491.038333
1961-04                    476.994287
1961-05                    480.967279
1961-06                    546.836805
1961-07                    604.372894
1961-08                    602.712875
1961-09                    525.352932
1961-10                    457.845247
1961-11                    399.012491
1961-12                    448.832705,
       sigma=         Number of airline passengers
1961-01                     13.983547
1961-02                     16.619133
1961-03                     18.890516
1961-04                     20.916682
1961-05                     22.763207
1961-06                     24.470791
1961-07                     26.066753
1961-08                     27.570484
1961-09                     28.996338
1961-10                     30.355290
1961-11                     31.655957
1961-12                     32.905252)</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># obtaining quantiles</span>
<span class="n">y_pred_dist</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th>0.1</th>
      <th>0.9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>423.360423</td>
      <td>459.201697</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>408.253714</td>
      <td>450.850267</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>466.829162</td>
      <td>515.247503</td>
    </tr>
    <tr>
      <th>1961-04</th>
      <td>450.188480</td>
      <td>503.800094</td>
    </tr>
    <tr>
      <th>1961-05</th>
      <td>451.795055</td>
      <td>510.139503</td>
    </tr>
    <tr>
      <th>1961-06</th>
      <td>515.476224</td>
      <td>578.197385</td>
    </tr>
    <tr>
      <th>1961-07</th>
      <td>570.967006</td>
      <td>637.778782</td>
    </tr>
    <tr>
      <th>1961-08</th>
      <td>567.379877</td>
      <td>638.045872</td>
    </tr>
    <tr>
      <th>1961-09</th>
      <td>488.192629</td>
      <td>562.513234</td>
    </tr>
    <tr>
      <th>1961-10</th>
      <td>418.943377</td>
      <td>496.747116</td>
    </tr>
    <tr>
      <th>1961-11</th>
      <td>358.443750</td>
      <td>439.581232</td>
    </tr>
    <tr>
      <th>1961-12</th>
      <td>406.662927</td>
      <td>491.002482</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="a-note-on-consistence-of-methods">
<h3>a note on consistence of methods<a class="headerlink" href="#a-note-on-consistence-of-methods" title="Link to this heading">#</a></h3>
<p>Outputs of <code class="docutils literal notranslate"><span class="pre">predict_interval</span></code>, <code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code>, <code class="docutils literal notranslate"><span class="pre">predict_var</span></code>, <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> are <em>typically</em> but not <em>necessarily</em> consistent with each other!</p>
<p>Consistency is weak interface requirement but not strictly enforced.</p>
</section>
<section id="using-probabilistic-forecasts-with-update-predict-stream-workflow">
<h3>Using probabilistic forecasts with update/predict stream workflow<a class="headerlink" href="#using-probabilistic-forecasts-with-update-predict-stream-workflow" title="Link to this heading">#</a></h3>
<p>Example:</p>
<ul class="simple">
<li><p>data observed monthly</p></li>
<li><p>make probabilistic forecasts for an entire year ahead</p></li>
<li><p>update forecasts every month</p></li>
<li><p>start in Dec 1950</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1949 and 1950</span>
<span class="n">y_start</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="mi">24</span><span class="p">]</span>
<span class="c1"># Jan 1951 etc</span>
<span class="n">y_update_batch_1</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;1951-01&quot;</span><span class="p">]]</span>
<span class="n">y_update_batch_2</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;1951-02&quot;</span><span class="p">]]</span>
<span class="n">y_update_batch_3</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;1951-03&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now = Dec 1950</span>

<span class="c1"># 1a. fit to data available in Dec 1950</span>
<span class="c1">#   fh = [1, 2, ..., 12] for all 12 months ahead</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_start</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>

<span class="c1"># 1b. predict 1951, in Dec 1950</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">()</span>
<span class="c1"># or other proba predict functions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1951-01</th>
      <td>125.707704</td>
      <td>141.743501</td>
    </tr>
    <tr>
      <th>1951-02</th>
      <td>135.554409</td>
      <td>154.421429</td>
    </tr>
    <tr>
      <th>1951-03</th>
      <td>149.921239</td>
      <td>171.246861</td>
    </tr>
    <tr>
      <th>1951-04</th>
      <td>140.807448</td>
      <td>164.336151</td>
    </tr>
    <tr>
      <th>1951-05</th>
      <td>127.941270</td>
      <td>153.483735</td>
    </tr>
    <tr>
      <th>1951-06</th>
      <td>152.968437</td>
      <td>180.377108</td>
    </tr>
    <tr>
      <th>1951-07</th>
      <td>167.194116</td>
      <td>196.349783</td>
    </tr>
    <tr>
      <th>1951-08</th>
      <td>166.316767</td>
      <td>197.120511</td>
    </tr>
    <tr>
      <th>1951-09</th>
      <td>150.425899</td>
      <td>182.793912</td>
    </tr>
    <tr>
      <th>1951-10</th>
      <td>128.623560</td>
      <td>162.483654</td>
    </tr>
    <tr>
      <th>1951-11</th>
      <td>109.567942</td>
      <td>144.857085</td>
    </tr>
    <tr>
      <th>1951-12</th>
      <td>125.641946</td>
      <td>162.304479</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># time passes, now = Jan 1951</span>

<span class="c1"># 2a. update forecaster with new data</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">y_update_batch_1</span><span class="p">)</span>

<span class="c1"># 2b. make new prediction - year ahead = Feb 1951 to Jan 1952</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">()</span>
<span class="c1"># forecaster remembers relative forecasting horizon</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1951-02</th>
      <td>136.659069</td>
      <td>152.694866</td>
    </tr>
    <tr>
      <th>1951-03</th>
      <td>150.894313</td>
      <td>169.761334</td>
    </tr>
    <tr>
      <th>1951-04</th>
      <td>141.748758</td>
      <td>163.074380</td>
    </tr>
    <tr>
      <th>1951-05</th>
      <td>128.876607</td>
      <td>152.405310</td>
    </tr>
    <tr>
      <th>1951-06</th>
      <td>153.906490</td>
      <td>179.448955</td>
    </tr>
    <tr>
      <th>1951-07</th>
      <td>168.170182</td>
      <td>195.578853</td>
    </tr>
    <tr>
      <th>1951-08</th>
      <td>167.339841</td>
      <td>196.495508</td>
    </tr>
    <tr>
      <th>1951-09</th>
      <td>151.478412</td>
      <td>182.282155</td>
    </tr>
    <tr>
      <th>1951-10</th>
      <td>129.682087</td>
      <td>162.050100</td>
    </tr>
    <tr>
      <th>1951-11</th>
      <td>110.621806</td>
      <td>144.481900</td>
    </tr>
    <tr>
      <th>1951-12</th>
      <td>126.787155</td>
      <td>162.076299</td>
    </tr>
    <tr>
      <th>1952-01</th>
      <td>121.345800</td>
      <td>158.008334</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>repeat the same commands with further data batches:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># time passes, now = Feb 1951</span>

<span class="c1"># 3a. update forecaster with new data</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">y_update_batch_2</span><span class="p">)</span>

<span class="c1"># 3b. make new prediction - year ahead = Feb 1951 to Jan 1952</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1951-03</th>
      <td>151.753982</td>
      <td>167.789779</td>
    </tr>
    <tr>
      <th>1951-04</th>
      <td>142.481495</td>
      <td>161.348516</td>
    </tr>
    <tr>
      <th>1951-05</th>
      <td>129.549167</td>
      <td>150.874789</td>
    </tr>
    <tr>
      <th>1951-06</th>
      <td>154.439352</td>
      <td>177.968055</td>
    </tr>
    <tr>
      <th>1951-07</th>
      <td>168.623271</td>
      <td>194.165737</td>
    </tr>
    <tr>
      <th>1951-08</th>
      <td>167.770158</td>
      <td>195.178829</td>
    </tr>
    <tr>
      <th>1951-09</th>
      <td>151.929536</td>
      <td>181.085203</td>
    </tr>
    <tr>
      <th>1951-10</th>
      <td>130.167441</td>
      <td>160.971184</td>
    </tr>
    <tr>
      <th>1951-11</th>
      <td>111.133646</td>
      <td>143.501659</td>
    </tr>
    <tr>
      <th>1951-12</th>
      <td>127.264937</td>
      <td>161.125031</td>
    </tr>
    <tr>
      <th>1952-01</th>
      <td>121.830853</td>
      <td>157.119997</td>
    </tr>
    <tr>
      <th>1952-02</th>
      <td>132.977078</td>
      <td>169.639611</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># time passes, now = Feb 1951</span>

<span class="c1"># 4a. update forecaster with new data</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">y_update_batch_3</span><span class="p">)</span>

<span class="c1"># 4b. make new prediction - year ahead = Feb 1951 to Jan 1952</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1951-04</th>
      <td>143.421396</td>
      <td>159.457193</td>
    </tr>
    <tr>
      <th>1951-05</th>
      <td>130.401349</td>
      <td>149.268370</td>
    </tr>
    <tr>
      <th>1951-06</th>
      <td>155.166695</td>
      <td>176.492317</td>
    </tr>
    <tr>
      <th>1951-07</th>
      <td>169.300595</td>
      <td>192.829298</td>
    </tr>
    <tr>
      <th>1951-08</th>
      <td>168.451797</td>
      <td>193.994262</td>
    </tr>
    <tr>
      <th>1951-09</th>
      <td>152.643518</td>
      <td>180.052188</td>
    </tr>
    <tr>
      <th>1951-10</th>
      <td>130.913776</td>
      <td>160.069443</td>
    </tr>
    <tr>
      <th>1951-11</th>
      <td>111.901401</td>
      <td>142.705144</td>
    </tr>
    <tr>
      <th>1951-12</th>
      <td>128.054892</td>
      <td>160.422905</td>
    </tr>
    <tr>
      <th>1952-01</th>
      <td>122.645624</td>
      <td>156.505718</td>
    </tr>
    <tr>
      <th>1952-02</th>
      <td>133.834698</td>
      <td>169.123842</td>
    </tr>
    <tr>
      <th>1952-03</th>
      <td>149.605867</td>
      <td>186.268400</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>… and so on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpandingWindowSplitter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_windows</span>

<span class="n">cv</span> <span class="o">=</span> <span class="n">ExpandingWindowSplitter</span><span class="p">(</span><span class="n">step_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">,</span> <span class="n">initial_window</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plot_windows</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">50</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x480 with 1 Axes&gt;,
 &lt;Axes: xlabel=&#39;Time&#39;, ylabel=&#39;Window number&#39;&gt;)
</pre></div>
</div>
<img alt="../../../../../../_images/2885d3da18d875412a86c4dc599fec8861a59dbd7ce637dd9087f27a37f082ae.png" src="../../../../../../_images/2885d3da18d875412a86c4dc599fec8861a59dbd7ce637dd9087f27a37f082ae.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<section id="probabilistic-forecasting-for-multivariate-and-hierarchical-data">
<h2>Probabilistic forecasting for multivariate and hierarchical data<a class="headerlink" href="#probabilistic-forecasting-for-multivariate-and-hierarchical-data" title="Link to this heading">#</a></h2>
<p>multivariate data: first column index for different variables</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_longley</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.var</span><span class="w"> </span><span class="kn">import</span> <span class="n">VAR</span>

<span class="n">_</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_longley</span><span class="p">()</span>

<span class="n">mv_forecaster</span> <span class="o">=</span> <span class="n">VAR</span><span class="p">()</span>

<span class="n">mv_forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="c1"># mv_forecaster.predict_var()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-e5c2eabd-3350-4069-b5d6-83608337e603 {color: black;background-color: white;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 pre{padding: 0;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-toggleable {background-color: white;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-estimator:hover {background-color: #d4ebff;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-item {z-index: 1;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-parallel-item:only-child::after {width: 0;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-e5c2eabd-3350-4069-b5d6-83608337e603 div.sk-text-repr-fallback {display: none;}</style><div id='sk-e5c2eabd-3350-4069-b5d6-83608337e603' class="sk-top-container"><div class="sk-text-repr-fallback"><pre>VAR()</pre><b>Please rerun this cell to show the HTML repr or trust the notebook.</b></div><div class="sk-container" hidden><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('dc8bcf3b-560c-4749-b6e1-21b0e100448f') type="checkbox" checked><label for=UUID('dc8bcf3b-560c-4749-b6e1-21b0e100448f') class='sk-toggleable__label sk-toggleable__label-arrow'>VAR</label><div class="sk-toggleable__content"><pre>VAR()</pre></div></div></div></div></div></div></div>
</div>
<p>hierarchical data: probabilistic forecasts per level are row-concatenated with a row hierarchy index</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils._testing.hierarchical</span><span class="w"> </span><span class="kn">import</span> <span class="n">_make_hierarchical</span>

<span class="n">y_hier</span> <span class="o">=</span> <span class="n">_make_hierarchical</span><span class="p">()</span>
<span class="n">y_hier</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>c0</th>
    </tr>
    <tr>
      <th>h0</th>
      <th>h1</th>
      <th>time</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">h0_0</th>
      <th rowspan="5" valign="top">h1_0</th>
      <th>2000-01-01</th>
      <td>3.450708</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>1.068651</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>2.595123</td>
    </tr>
    <tr>
      <th>2000-01-04</th>
      <td>1.962971</td>
    </tr>
    <tr>
      <th>2000-01-05</th>
      <td>2.143540</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">h0_1</th>
      <th rowspan="5" valign="top">h1_3</th>
      <th>2000-01-08</th>
      <td>3.023834</td>
    </tr>
    <tr>
      <th>2000-01-09</th>
      <td>2.773544</td>
    </tr>
    <tr>
      <th>2000-01-10</th>
      <td>3.947530</td>
    </tr>
    <tr>
      <th>2000-01-11</th>
      <td>4.162686</td>
    </tr>
    <tr>
      <th>2000-01-12</th>
      <td>4.430358</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">()</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_hier</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">c0</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
    <tr>
      <th>h0</th>
      <th>h1</th>
      <th>time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="12" valign="top">h0_0</th>
      <th rowspan="3" valign="top">h1_0</th>
      <th>2000-01-13</th>
      <td>1.272469</td>
      <td>3.985653</td>
    </tr>
    <tr>
      <th>2000-01-14</th>
      <td>1.264236</td>
      <td>3.977535</td>
    </tr>
    <tr>
      <th>2000-01-15</th>
      <td>1.264161</td>
      <td>3.977459</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_1</th>
      <th>2000-01-13</th>
      <td>0.972399</td>
      <td>4.251948</td>
    </tr>
    <tr>
      <th>2000-01-14</th>
      <td>1.053894</td>
      <td>4.378815</td>
    </tr>
    <tr>
      <th>2000-01-15</th>
      <td>1.035877</td>
      <td>4.362053</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_2</th>
      <th>2000-01-13</th>
      <td>0.751231</td>
      <td>4.124777</td>
    </tr>
    <tr>
      <th>2000-01-14</th>
      <td>1.000178</td>
      <td>4.442776</td>
    </tr>
    <tr>
      <th>2000-01-15</th>
      <td>0.941117</td>
      <td>4.386541</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_3</th>
      <th>2000-01-13</th>
      <td>0.731900</td>
      <td>3.634079</td>
    </tr>
    <tr>
      <th>2000-01-14</th>
      <td>0.785021</td>
      <td>3.694407</td>
    </tr>
    <tr>
      <th>2000-01-15</th>
      <td>0.781003</td>
      <td>3.690425</td>
    </tr>
    <tr>
      <th rowspan="12" valign="top">h0_1</th>
      <th rowspan="3" valign="top">h1_0</th>
      <th>2000-01-13</th>
      <td>1.487011</td>
      <td>4.864117</td>
    </tr>
    <tr>
      <th>2000-01-14</th>
      <td>0.967862</td>
      <td>4.475667</td>
    </tr>
    <tr>
      <th>2000-01-15</th>
      <td>1.090278</td>
      <td>4.608189</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_1</th>
      <th>2000-01-13</th>
      <td>1.265018</td>
      <td>3.583124</td>
    </tr>
    <tr>
      <th>2000-01-14</th>
      <td>1.264389</td>
      <td>3.582495</td>
    </tr>
    <tr>
      <th>2000-01-15</th>
      <td>1.264389</td>
      <td>3.582495</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_2</th>
      <th>2000-01-13</th>
      <td>1.737677</td>
      <td>3.788332</td>
    </tr>
    <tr>
      <th>2000-01-14</th>
      <td>1.776574</td>
      <td>3.858465</td>
    </tr>
    <tr>
      <th>2000-01-15</th>
      <td>1.785649</td>
      <td>3.868493</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">h1_3</th>
      <th>2000-01-13</th>
      <td>2.612481</td>
      <td>5.168085</td>
    </tr>
    <tr>
      <th>2000-01-14</th>
      <td>2.001773</td>
      <td>5.064990</td>
    </tr>
    <tr>
      <th>2000-01-15</th>
      <td>1.667430</td>
      <td>4.927624</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>(more about this in the hierarchical forecasting notebook)</p>
<hr class="docutils" />
</section>
<section id="metrics-for-probabilistic-forecasts-and-evaluation">
<h2>Metrics for probabilistic forecasts and evaluation<a class="headerlink" href="#metrics-for-probabilistic-forecasts-and-evaluation" title="Link to this heading">#</a></h2>
<section id="overview-theory">
<h3>overview - theory<a class="headerlink" href="#overview-theory" title="Link to this heading">#</a></h3>
<p>Predicted <code class="docutils literal notranslate"><span class="pre">y</span></code> has different form from true <code class="docutils literal notranslate"><span class="pre">y</span></code>, so metrics have form</p>
<p><code class="docutils literal notranslate"><span class="pre">metric(y_true:</span> <span class="pre">series,</span> <span class="pre">y_pred:</span> <span class="pre">proba_prediction)</span> <span class="pre">-&gt;</span> <span class="pre">float</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">proba_prediction</span></code> is the type of the specific “probabilistic prediction type”.</p>
<p>I.e., we have the following function signature for a loss/metric <span class="math notranslate nohighlight">\(L\)</span>:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>param</p></th>
<th class="head"><p>prediction/estimate of</p></th>
<th class="head"><p>general form</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>point forecast</p></td>
<td><p></p></td>
<td><p>conditional expectation <span class="math notranslate nohighlight">\(\mathbb{E}[y'|y]\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>variance forecast</p></td>
<td><p></p></td>
<td><p>conditional variance <span class="math notranslate nohighlight">\(Var[y'|y]\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">metric(y_pred,</span> <span class="pre">y_pt,</span> <span class="pre">y_var)</span></code> (requires point forecast too)</p></td>
</tr>
<tr class="row-even"><td><p>quantile forecast</p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\in (0,1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\alpha\)</span>-quantile of <span class="math notranslate nohighlight">\(y'|y\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_quantiles,</span> <span class="pre">alpha)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>interval forecast</p></td>
<td><p><span class="math notranslate nohighlight">\(c\in (0,1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\([a,b]\)</span> s.t. <span class="math notranslate nohighlight">\(P(a\le y' \le b| y) = c\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_interval,</span> <span class="pre">c)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>distribution forecast</p></td>
<td><p></p></td>
<td><p>the law/distribution of <span class="math notranslate nohighlight">\(y'|y\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_distribution)</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="metrics-general-signature-and-averaging">
<h3>metrics: general signature and averaging<a class="headerlink" href="#metrics-general-signature-and-averaging" title="Link to this heading">#</a></h3>
<p>intro using the example of the quantile loss aka interval loss aka pinball loss, in the univariate case.</p>
<p>For one quantile value <span class="math notranslate nohighlight">\(\alpha\)</span>, the (per-sample) pinball loss function is defined as<br />
<span class="math notranslate nohighlight">\(L_{\alpha}(\widehat{y}, y) := \alpha \cdot \Theta (y - \widehat{y}) + (1-\alpha) \cdot \Theta (\widehat{y} - y)\)</span>,<br />
where <span class="math notranslate nohighlight">\(\Theta (x) := [1\)</span> if <span class="math notranslate nohighlight">\(x\ge 0\)</span> and <span class="math notranslate nohighlight">\(0\)</span> otherwise <span class="math notranslate nohighlight">\(]\)</span> is the Heaviside function.</p>
<p>This can be used to evaluate:</p>
<ul class="simple">
<li><p><em>multiple quantile</em> forecasts <span class="math notranslate nohighlight">\(\widehat{\bf y}:=\widehat{y}_1, \dots, \widehat{y}_k\)</span> for quantiles <span class="math notranslate nohighlight">\(\bm{\alpha} = \alpha_1,\dots, \alpha_k\)</span> via<br />
<span class="math notranslate nohighlight">\(L_{\bm{\alpha}}(\widehat{\bf y}, y) := \frac{1}{k}\sum_{i=1}^k L_{\alpha_i}(\widehat{y}_i, y)\)</span></p></li>
<li><p><em>interval forecasts</em> <span class="math notranslate nohighlight">\([\widehat{a}, \widehat{b}]\)</span> at symmetric coverage <span class="math notranslate nohighlight">\(c\)</span> via<br />
<span class="math notranslate nohighlight">\(L_c([\widehat{a},\widehat{b}], y) := \frac{1}{2} L_{\alpha_{low}}(\widehat{a}, y) + \frac{1}{2}L_{\alpha_{high}}(\widehat{b}, y)\)</span> where <span class="math notranslate nohighlight">\(\alpha_{low} = \frac{1-c}{2}, \alpha_{high} = \frac{1+c}{2}\)</span></p></li>
</ul>
<p>(all are known to be strictly proper losses for their respective prediction object)</p>
<p>There are <em>three things we can choose to average over</em>:</p>
<ul class="simple">
<li><p>quantile values, if multiple are predicted - elements of <code class="docutils literal notranslate"><span class="pre">alpha</span></code> in <code class="docutils literal notranslate"><span class="pre">predict_interval(fh,</span> <span class="pre">alpha)</span></code></p></li>
<li><p>time stamps in the forecasting horizon <code class="docutils literal notranslate"><span class="pre">fh</span></code> - elements of <code class="docutils literal notranslate"><span class="pre">fh</span></code> in <code class="docutils literal notranslate"><span class="pre">fit(fh)</span></code> resp <code class="docutils literal notranslate"><span class="pre">predict_interval(fh,</span> <span class="pre">alpha)</span></code></p></li>
<li><p>variables in <code class="docutils literal notranslate"><span class="pre">y</span></code>, in case of multivariate (later, first we look at univariate)</p></li>
</ul>
<p>We will show quantile values and time stamps first:</p>
<ol class="arabic simple">
<li><p>averaging by <code class="docutils literal notranslate"><span class="pre">fh</span></code> time stamps only -&gt; one number per quantile value in <code class="docutils literal notranslate"><span class="pre">alpha</span></code></p></li>
<li><p>averaging over nothing -&gt; one number per quantile value in <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">fh</span></code> time stamp</p></li>
<li><p>averaging over both <code class="docutils literal notranslate"><span class="pre">fh</span></code> and quantile values in <code class="docutils literal notranslate"><span class="pre">alpha</span></code> -&gt; one number</p></li>
</ol>
<p>first, generating some quantile predictions.
<code class="docutils literal notranslate"><span class="pre">pred_quantiles</span></code> now contains quantile forecasts<br />
formally, forecasts <span class="math notranslate nohighlight">\(\widehat{y}_j(t_i)\)</span> where <span class="math notranslate nohighlight">\(\widehat{y_j}\)</span> are forecasts at quantile <span class="math notranslate nohighlight">\(\alpha_j\)</span>, with range <span class="math notranslate nohighlight">\(i=1\dots N, j=1\dots k\)</span><br />
<span class="math notranslate nohighlight">\(\alpha_j\)</span> are the elements of <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, and <span class="math notranslate nohighlight">\(t_i\)</span> are the future time stamps indexed by <code class="docutils literal notranslate"><span class="pre">fh</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.theta</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThetaForecaster</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">24</span><span class="p">]</span>  <span class="c1"># train on 24 months, 1949 and 1950</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()[</span><span class="mi">24</span><span class="p">:</span><span class="mi">36</span><span class="p">]</span>  <span class="c1"># ground truth for 12 months in 1951</span>

<span class="c1"># try to forecast 12 months ahead, from y_train</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">ThetaForecaster</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>

<span class="n">pred_quantiles</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_quantiles</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="n">pred_quantiles</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="5" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th>0.10</th>
      <th>0.25</th>
      <th>0.50</th>
      <th>0.75</th>
      <th>0.90</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1951-01</th>
      <td>127.478633</td>
      <td>130.437778</td>
      <td>133.725603</td>
      <td>137.013427</td>
      <td>139.972572</td>
    </tr>
    <tr>
      <th>1951-02</th>
      <td>137.638007</td>
      <td>141.119608</td>
      <td>144.987919</td>
      <td>148.856230</td>
      <td>152.337831</td>
    </tr>
    <tr>
      <th>1951-03</th>
      <td>152.276355</td>
      <td>156.211651</td>
      <td>160.584050</td>
      <td>164.956449</td>
      <td>168.891745</td>
    </tr>
    <tr>
      <th>1951-04</th>
      <td>143.405864</td>
      <td>147.747702</td>
      <td>152.571799</td>
      <td>157.395897</td>
      <td>161.737735</td>
    </tr>
    <tr>
      <th>1951-05</th>
      <td>130.762077</td>
      <td>135.475523</td>
      <td>140.712503</td>
      <td>145.949483</td>
      <td>150.662928</td>
    </tr>
    <tr>
      <th>1951-06</th>
      <td>155.995341</td>
      <td>161.053164</td>
      <td>166.672772</td>
      <td>172.292381</td>
      <td>177.350204</td>
    </tr>
    <tr>
      <th>1951-07</th>
      <td>170.413951</td>
      <td>175.794154</td>
      <td>181.771950</td>
      <td>187.749746</td>
      <td>193.129949</td>
    </tr>
    <tr>
      <th>1951-08</th>
      <td>169.718609</td>
      <td>175.402937</td>
      <td>181.718639</td>
      <td>188.034340</td>
      <td>193.718669</td>
    </tr>
    <tr>
      <th>1951-09</th>
      <td>154.000492</td>
      <td>159.973481</td>
      <td>166.609905</td>
      <td>173.246330</td>
      <td>179.219318</td>
    </tr>
    <tr>
      <th>1951-10</th>
      <td>132.362933</td>
      <td>138.611261</td>
      <td>145.553607</td>
      <td>152.495953</td>
      <td>158.744281</td>
    </tr>
    <tr>
      <th>1951-11</th>
      <td>113.465133</td>
      <td>119.977169</td>
      <td>127.212513</td>
      <td>134.447858</td>
      <td>140.959894</td>
    </tr>
    <tr>
      <th>1951-12</th>
      <td>129.690809</td>
      <td>136.456281</td>
      <td>143.973212</td>
      <td>151.490143</td>
      <td>158.255616</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple">
<li><p>computing the loss by quantile point or interval end, averaged over <code class="docutils literal notranslate"><span class="pre">fh</span></code> time stamps<br />
i.e., <span class="math notranslate nohighlight">\(\frac{1}{N} \sum_{i=1}^N L_{\alpha}(\widehat{y}(t_i), y(t_i))\)</span> for <span class="math notranslate nohighlight">\(t_i\)</span> in the <code class="docutils literal notranslate"><span class="pre">fh</span></code>, and every <code class="docutils literal notranslate"><span class="pre">alpha</span></code>,
this is one number per quantile value in <code class="docutils literal notranslate"><span class="pre">alpha</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting.probabilistic</span><span class="w"> </span><span class="kn">import</span> <span class="n">PinballLoss</span>

<span class="n">loss</span> <span class="o">=</span> <span class="n">PinballLoss</span><span class="p">(</span><span class="n">score_average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">loss</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">pred_quantiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.10    2.706598
0.25    5.494569
0.50    8.162730
0.75    8.004485
0.90    5.221264
Name: 0, dtype: float64
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>computing the the individual loss values, by sample, no averaging,<br />
i.e., <span class="math notranslate nohighlight">\(L_{\alpha}(\widehat{y}(t_i), y(t_i))\)</span> for every <span class="math notranslate nohighlight">\(t_i\)</span> in <code class="docutils literal notranslate"><span class="pre">fh</span></code> and every <span class="math notranslate nohighlight">\(\alpha\)</span> in <code class="docutils literal notranslate"><span class="pre">alpha</span></code><br />
this is one number per quantile value <span class="math notranslate nohighlight">\(\alpha\)</span> in <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and time point <span class="math notranslate nohighlight">\(t_i\)</span> in <code class="docutils literal notranslate"><span class="pre">fh</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss</span><span class="o">.</span><span class="n">evaluate_by_index</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">pred_quantiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0.10</th>
      <th>0.25</th>
      <th>0.50</th>
      <th>0.75</th>
      <th>0.90</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.752137</td>
      <td>3.640556</td>
      <td>5.637199</td>
      <td>5.989930</td>
      <td>4.524685</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.236199</td>
      <td>2.220098</td>
      <td>2.506040</td>
      <td>0.857827</td>
      <td>0.233783</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.572365</td>
      <td>5.447087</td>
      <td>8.707975</td>
      <td>9.782663</td>
      <td>8.197430</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.959414</td>
      <td>3.813075</td>
      <td>5.214100</td>
      <td>4.203077</td>
      <td>1.136038</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.123792</td>
      <td>9.131119</td>
      <td>15.643749</td>
      <td>19.537888</td>
      <td>19.203365</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.200466</td>
      <td>4.236709</td>
      <td>5.663614</td>
      <td>4.280714</td>
      <td>0.584816</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2.858605</td>
      <td>5.801461</td>
      <td>8.614025</td>
      <td>8.437691</td>
      <td>5.283046</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2.928139</td>
      <td>5.899266</td>
      <td>8.640681</td>
      <td>8.224245</td>
      <td>4.753198</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2.999951</td>
      <td>6.006630</td>
      <td>8.695047</td>
      <td>8.065253</td>
      <td>4.302613</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2.963707</td>
      <td>5.847185</td>
      <td>8.223196</td>
      <td>7.128035</td>
      <td>2.930147</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3.253487</td>
      <td>6.505708</td>
      <td>9.393743</td>
      <td>8.664106</td>
      <td>4.536096</td>
    </tr>
    <tr>
      <th>11</th>
      <td>3.630919</td>
      <td>7.385930</td>
      <td>11.013394</td>
      <td>10.882393</td>
      <td>6.969946</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple" start="3">
<li><p>computing the loss for a multiple quantile forecast, averaged over <code class="docutils literal notranslate"><span class="pre">fh</span></code> time stamps and quantile values <code class="docutils literal notranslate"><span class="pre">alpha</span></code><br />
i.e., <span class="math notranslate nohighlight">\(\frac{1}{Nk} \sum_{j=1}^k\sum_{i=1}^N L_{\alpha_j}(\widehat{y_j}(t_i), y(t_i))\)</span> for <span class="math notranslate nohighlight">\(t_i\)</span> in <code class="docutils literal notranslate"><span class="pre">fh</span></code>, and quantile values <span class="math notranslate nohighlight">\(\alpha_j\)</span>,<br />
this is a single number that can be used in tuning (e.g., grid search) or evaluation overall</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting.probabilistic</span><span class="w"> </span><span class="kn">import</span> <span class="n">PinballLoss</span>

<span class="n">loss_multi</span> <span class="o">=</span> <span class="n">PinballLoss</span><span class="p">(</span><span class="n">score_average</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">loss_multi</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">pred_quantiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.917929182515448
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="4">
<li><p>computing the loss for a multiple quantile forecast, averaged quantile values <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, for individual time stamps<br />
i.e., <span class="math notranslate nohighlight">\(\frac{1}{k} \sum_{j=1}^k L_{\alpha_j}(\widehat{y_j}(t_i), y(t_i))\)</span> for <span class="math notranslate nohighlight">\(t_i\)</span> in <code class="docutils literal notranslate"><span class="pre">fh</span></code>, and quantile values <span class="math notranslate nohighlight">\(\alpha_j\)</span>,<br />
this is a univariate time series at <code class="docutils literal notranslate"><span class="pre">fh</span></code> times <span class="math notranslate nohighlight">\(t_i\)</span>, it can be used for tuning or evaluation by horizon index</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss_multi</span><span class="o">.</span><span class="n">evaluate_by_index</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">pred_quantiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      4.308901
1      1.410790
2      6.941504
3      3.265141
4     13.527983
5      3.393264
6      6.198966
7      6.089106
8      6.013899
9      5.418454
10     6.470628
11     7.976516
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Question: why is <code class="docutils literal notranslate"><span class="pre">score_average</span></code> a constructor flag, and <code class="docutils literal notranslate"><span class="pre">evaluate_by_index</span></code> a method?</p>
<ul class="simple">
<li><p>not all losses are “by index”, so <code class="docutils literal notranslate"><span class="pre">evaluate_by_index</span></code> logic can vary (e.g., pseudo-samples)</p></li>
<li><p>constructor args define “mathematical object” of scientific signature: series -&gt; non-temporal object<br />
methods define action or “way to apply”, e.g., as used in tuning or reporting</p></li>
</ul>
<p>Compare <code class="docutils literal notranslate"><span class="pre">score_average</span></code> to <code class="docutils literal notranslate"><span class="pre">multioutput</span></code> arg in <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> metrics and <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.</p>
</section>
<section id="metrics-interval-vs-quantile-metrics">
<h3>metrics: interval vs quantile metrics<a class="headerlink" href="#metrics-interval-vs-quantile-metrics" title="Link to this heading">#</a></h3>
<p>Interval and quantile metrics can be used interchangeably:</p>
<p>internally, these are easily convertible to each other<br />
recall: lower/upper interval = quantiles at <span class="math notranslate nohighlight">\(\frac{1}{2} \pm \frac{1}2\)</span> <code class="docutils literal notranslate"><span class="pre">coverage</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_interval</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span><span class="n">coverage</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">pred_interval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.8</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1951-01</th>
      <td>127.478633</td>
      <td>139.972572</td>
    </tr>
    <tr>
      <th>1951-02</th>
      <td>137.638007</td>
      <td>152.337831</td>
    </tr>
    <tr>
      <th>1951-03</th>
      <td>152.276355</td>
      <td>168.891745</td>
    </tr>
    <tr>
      <th>1951-04</th>
      <td>143.405864</td>
      <td>161.737735</td>
    </tr>
    <tr>
      <th>1951-05</th>
      <td>130.762077</td>
      <td>150.662928</td>
    </tr>
    <tr>
      <th>1951-06</th>
      <td>155.995341</td>
      <td>177.350204</td>
    </tr>
    <tr>
      <th>1951-07</th>
      <td>170.413951</td>
      <td>193.129949</td>
    </tr>
    <tr>
      <th>1951-08</th>
      <td>169.718609</td>
      <td>193.718669</td>
    </tr>
    <tr>
      <th>1951-09</th>
      <td>154.000492</td>
      <td>179.219318</td>
    </tr>
    <tr>
      <th>1951-10</th>
      <td>132.362933</td>
      <td>158.744281</td>
    </tr>
    <tr>
      <th>1951-11</th>
      <td>113.465133</td>
      <td>140.959894</td>
    </tr>
    <tr>
      <th>1951-12</th>
      <td>129.690809</td>
      <td>158.255616</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>loss object recognizes input type automatically and computes corresponding interval loss</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">pred_interval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1    2.706598
0.9    5.221264
Name: 0, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loss_multi</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">pred_interval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.9639309489968992
</pre></div>
</div>
</div>
</div>
</section>
<section id="evaluation-by-backtesting">
<h3>evaluation by backtesting<a class="headerlink" href="#evaluation-by-backtesting" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.model_evaluation</span><span class="w"> </span><span class="kn">import</span> <span class="n">evaluate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.theta</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThetaForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting.probabilistic</span><span class="w"> </span><span class="kn">import</span> <span class="n">PinballLoss</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpandingWindowSplitter</span>

<span class="c1"># 1. define data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>

<span class="c1"># 2. define splitting/backtesting regime</span>
<span class="n">fh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">ExpandingWindowSplitter</span><span class="p">(</span><span class="n">step_length</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">,</span> <span class="n">initial_window</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>

<span class="c1"># 3. define loss to use</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">PinballLoss</span><span class="p">()</span>
<span class="c1"># default is score_average=True and multi_output=&quot;uniform_average&quot;, so gives a number</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">ThetaForecaster</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;refit&quot;</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">loss</span>
<span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>test_PinballLoss</th>
      <th>fit_time</th>
      <th>pred_quantiles_time</th>
      <th>len_train_window</th>
      <th>cutoff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.865788</td>
      <td>0.015025</td>
      <td>0.014592</td>
      <td>72</td>
      <td>1954-12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.958340</td>
      <td>0.015472</td>
      <td>0.016391</td>
      <td>84</td>
      <td>1955-12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.981744</td>
      <td>0.013963</td>
      <td>0.014190</td>
      <td>96</td>
      <td>1956-12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.411309</td>
      <td>0.014387</td>
      <td>0.014581</td>
      <td>108</td>
      <td>1957-12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.187200</td>
      <td>0.015383</td>
      <td>0.014267</td>
      <td>120</td>
      <td>1958-12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>each row is one train/test split in the walkforward setting</p></li>
<li><p>first col is the loss on the test fold</p></li>
<li><p>last two columns summarize length of training window, cutoff between train/test</p></li>
</ul>
<p>roadmap items:</p>
<p>implementing further metrics</p>
<ul class="simple">
<li><p>distribution prediction metrics - may need tfp extension</p></li>
<li><p>advanced evaluation set-ups</p></li>
<li><p>variance loss</p></li>
</ul>
<p>contributions are appreciated!</p>
</section>
<section id="visual-evaluation">
<h3>Visual Evaluation<a class="headerlink" href="#visual-evaluation" title="Link to this heading">#</a></h3>
<p>Often, the probabilistic forecast’s calibration is important. I.e., how many values are smaller then the 0.1 quantile, 0.2 quantile, etc.</p>
<p>This evaluation can be made using calibration plots:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.utils.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_calibration</span>

<span class="n">plot_calibration</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pred_quantiles</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">pred_quantiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1600x400 with 1 Axes&gt;, &lt;Axes: &gt;)
</pre></div>
</div>
<img alt="../../../../../../_images/8a6f30873d6f7776474c2679f4b7b024e47153c08f9bd2cbdda365cf599a3249.png" src="../../../../../../_images/8a6f30873d6f7776474c2679f4b7b024e47153c08f9bd2cbdda365cf599a3249.png" />
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="advanced-composition-pipelines-tuning-reduction-adding-proba-forecasts-to-any-estimator">
<h2>Advanced composition: pipelines, tuning, reduction, adding proba forecasts to any estimator<a class="headerlink" href="#advanced-composition-pipelines-tuning-reduction-adding-proba-forecasts-to-any-estimator" title="Link to this heading">#</a></h2>
<p>composition = constructing “composite” estimators out of multiple “component” estimators</p>
<ul class="simple">
<li><p><strong>reduction</strong> = building estimator type A using estimator type B</p>
<ul>
<li><p>special case: adding proba forecasting capability to non-proba forecaster</p></li>
<li><p>special case: using proba supervised learner for  proba forecasting</p></li>
</ul>
</li>
<li><p><strong>pipelining</strong> = chaining estimators, here: transformers to a forecaster</p></li>
<li><p><strong>tuning</strong> = automated hyper-parameter fitting, usually via internal evaluation loop</p>
<ul>
<li><p>special case: grid parameter search and random parameter search tuning</p></li>
<li><p>special case: “Auto-ML”, optimizing not just estimator hyper-parameter but also choice of estimator</p></li>
</ul>
</li>
</ul>
<section id="adding-probabilistic-forecasts-to-non-probabilistic-forecasters">
<h3>Adding probabilistic forecasts to non-probabilistic forecasters<a class="headerlink" href="#adding-probabilistic-forecasts-to-non-probabilistic-forecasters" title="Link to this heading">#</a></h3>
<p>start with a forecaster that does not produce probabilistic predictions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.exp_smoothing</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentialSmoothing</span>

<span class="n">my_forecaster</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">()</span>

<span class="c1"># does the forecaster support probabilistic predictions?</span>
<span class="n">my_forecaster</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s2">&quot;capability:pred_int&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>adding probabilistic predictions is possible via reduction wrappers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NaiveVariance adds intervals &amp; variance via collecting past residuals</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveVariance</span>

<span class="c1"># create a composite forecaster like this:</span>
<span class="n">my_forecaster_with_proba</span> <span class="o">=</span> <span class="n">NaiveVariance</span><span class="p">(</span><span class="n">my_forecaster</span><span class="p">)</span>

<span class="c1"># does it support probabilistic predictions now?</span>
<span class="n">my_forecaster_with_proba</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="s2">&quot;capability:pred_int&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>the composite can now be used like any probabilistic forecaster:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()</span>

<span class="n">my_forecaster_with_proba</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">my_forecaster_with_proba</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1961-01</th>
      <td>341.961956</td>
      <td>522.038042</td>
    </tr>
    <tr>
      <th>1961-02</th>
      <td>319.816275</td>
      <td>544.183724</td>
    </tr>
    <tr>
      <th>1961-03</th>
      <td>307.298374</td>
      <td>556.701625</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>roadmap items:</p>
<p>more compositors to enable probabilistic forecasting</p>
<ul class="simple">
<li><p>bootstrap forecast intervals</p></li>
<li><p>reduction to probabilistic supervised learning</p></li>
<li><p>popular “add probabilistic capability” wrappers</p></li>
</ul>
<p>contributions are appreciated!</p>
</section>
<section id="tuning-and-automl">
<h3>Tuning and AutoML<a class="headerlink" href="#tuning-and-automl" title="Link to this heading">#</a></h3>
<p>tuning and autoML with probabilistic forecasters works exactly like with “ordinary” forecasters<br />
via <code class="docutils literal notranslate"><span class="pre">ForecastingGridSearchCV</span></code> or <code class="docutils literal notranslate"><span class="pre">ForecastingRandomSearchCV</span></code></p>
<ul class="simple">
<li><p>change metric to tune to a probabilistic metric</p></li>
<li><p>use a corresponding probabilistic metric or loss function</p></li>
</ul>
<p>Internally, evaluation will be done using probabilistic metric, via backtesting evaluation.</p>
<p><strong>important</strong>: to evaluate the tuned estimator, use it in <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> or a separate benchmarking workflow.<br />
Using internal metric/loss values amounts to in-sample evaluation, which is over-optimistic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingGridSearchCV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.theta</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThetaForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.performance_metrics.forecasting.probabilistic</span><span class="w"> </span><span class="kn">import</span> <span class="n">PinballLoss</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">SlidingWindowSplitter</span>

<span class="c1"># forecaster we want to tune</span>
<span class="n">forecaster</span> <span class="o">=</span> <span class="n">ThetaForecaster</span><span class="p">()</span>

<span class="c1"># parameter grid to search over</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">]}</span>

<span class="c1"># evaluation/backtesting regime for *tuning*</span>
<span class="n">fh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># fh for tuning regime, does not need to be same as in fit/predict!</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">SlidingWindowSplitter</span><span class="p">(</span><span class="n">window_length</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>
<span class="n">scoring</span> <span class="o">=</span> <span class="n">PinballLoss</span><span class="p">()</span>

<span class="c1"># construct the composite forecaster with grid search compositor</span>
<span class="n">gscv</span> <span class="o">=</span> <span class="n">ForecastingGridSearchCV</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;refit&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_airline</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">load_airline</span><span class="p">()[:</span><span class="mi">60</span><span class="p">]</span>

<span class="n">gscv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 {color: black;background-color: white;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 pre{padding: 0;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-toggleable {background-color: white;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-estimator:hover {background-color: #d4ebff;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-item {z-index: 1;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-parallel-item:only-child::after {width: 0;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-56ea55f7-b50b-4471-b75c-27c44a92e584 div.sk-text-repr-fallback {display: none;}</style><div id='sk-56ea55f7-b50b-4471-b75c-27c44a92e584' class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ForecastingGridSearchCV(cv=SlidingWindowSplitter(fh=[1, 2, 3],
                                                 window_length=36),
                        forecaster=ThetaForecaster(),
                        param_grid={&#x27;sp&#x27;: [1, 6, 12]}, scoring=PinballLoss())</pre><b>Please rerun this cell to show the HTML repr or trust the notebook.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class='sk-label-container'><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('fbfcc395-535c-4585-938a-9b8e6763ed9f') type="checkbox" ><label for=UUID('fbfcc395-535c-4585-938a-9b8e6763ed9f') class='sk-toggleable__label sk-toggleable__label-arrow'>ForecastingGridSearchCV</label><div class="sk-toggleable__content"><pre>ForecastingGridSearchCV(cv=SlidingWindowSplitter(fh=[1, 2, 3],
                                                 window_length=36),
                        forecaster=ThetaForecaster(),
                        param_grid={&#x27;sp&#x27;: [1, 6, 12]}, scoring=PinballLoss())</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('f58eede4-ccfd-48c7-a17a-85a43fcbfa5c') type="checkbox" ><label for=UUID('f58eede4-ccfd-48c7-a17a-85a43fcbfa5c') class='sk-toggleable__label sk-toggleable__label-arrow'>SlidingWindowSplitter</label><div class="sk-toggleable__content"><pre>SlidingWindowSplitter(fh=[1, 2, 3], window_length=36)</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('086c05d7-312e-48a7-86c0-a5e0027790e4') type="checkbox" ><label for=UUID('086c05d7-312e-48a7-86c0-a5e0027790e4') class='sk-toggleable__label sk-toggleable__label-arrow'>ThetaForecaster</label><div class="sk-toggleable__content"><pre>ThetaForecaster()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class='sk-item'><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=UUID('f45eea71-42a4-4ebd-a603-5dbe5d174882') type="checkbox" ><label for=UUID('f45eea71-42a4-4ebd-a603-5dbe5d174882') class='sk-toggleable__label sk-toggleable__label-arrow'>PinballLoss</label><div class="sk-toggleable__content"><pre>PinballLoss()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<p>inspect hyper-parameter fit obtained by tuning:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;sp&#39;: 12}
</pre></div>
</div>
</div>
</div>
<p>obtain predictions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gscv</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Number of airline passengers</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1954-01</th>
      <td>190.832914</td>
      <td>217.164705</td>
    </tr>
    <tr>
      <th>1954-02</th>
      <td>195.638431</td>
      <td>226.620355</td>
    </tr>
    <tr>
      <th>1954-03</th>
      <td>221.947947</td>
      <td>256.967884</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>for AutoML, use the <code class="docutils literal notranslate"><span class="pre">MultiplexForecaster</span></code> to select among multiple forecasters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiplexForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.exp_smoothing</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveForecaster</span><span class="p">,</span> <span class="n">NaiveVariance</span>

<span class="n">forecaster</span> <span class="o">=</span> <span class="n">MultiplexForecaster</span><span class="p">(</span>
    <span class="n">forecasters</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;naive&quot;</span><span class="p">,</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;ets&quot;</span><span class="p">,</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span>
    <span class="p">],</span>
<span class="p">)</span>

<span class="n">forecaster_param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;selected_forecaster&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ets&quot;</span><span class="p">,</span> <span class="s2">&quot;naive&quot;</span><span class="p">]}</span>
<span class="n">gscv</span> <span class="o">=</span> <span class="n">ForecastingGridSearchCV</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">forecaster_param_grid</span><span class="p">)</span>

<span class="n">gscv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">gscv</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;selected_forecaster&#39;: &#39;naive&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="pipelines-with-probabilistic-forecasters">
<h3>Pipelines with probabilistic forecasters<a class="headerlink" href="#pipelines-with-probabilistic-forecasters" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sktime</span></code> pipelines are compatible with probabilistic forecasters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ForecastingPipeline</span></code> applies transformers to the exogeneous <code class="docutils literal notranslate"><span class="pre">X</span></code> argument before passing them to the forecaster</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TransformedTargetForecaster</span></code> transforms <code class="docutils literal notranslate"><span class="pre">y</span></code> and back-transforms forecasts, including interval or quantile forecasts</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">ForecastingPipeline</span></code> takes a chain of transformers and forecasters, say,</p>
<p><code class="docutils literal notranslate"><span class="pre">[t1,</span> <span class="pre">t2,</span> <span class="pre">...,</span> <span class="pre">tn,</span> <span class="pre">f]</span></code>,</p>
<p>where <code class="docutils literal notranslate"><span class="pre">t[i]</span></code> are forecasters that pre-process, and <code class="docutils literal notranslate"><span class="pre">tp[i]</span></code> are forecasters that postprocess</p>
<section id="fit-y-x-fh-does">
<h4><code class="docutils literal notranslate"><span class="pre">fit(y,</span> <span class="pre">X,</span> <span class="pre">fh)</span></code> does:<a class="headerlink" href="#fit-y-x-fh-does" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">X1</span> <span class="pre">=</span> <span class="pre">t1.fit_transform(X)</span></code><br />
<code class="docutils literal notranslate"><span class="pre">X2</span> <span class="pre">=</span> <span class="pre">t2.fit_transform(X1)</span></code><br />
etc<br />
<code class="docutils literal notranslate"><span class="pre">X[n]</span> <span class="pre">=</span> <span class="pre">t3.fit_transform(X[n-1])</span></code>\</p>
<p><code class="docutils literal notranslate"><span class="pre">f.fit(y=y,</span> <span class="pre">x=X[n])</span></code></p>
</section>
<section id="predict-sth-x-fh-does">
<h4><code class="docutils literal notranslate"><span class="pre">predict_[sth](X,</span> <span class="pre">fh)</span></code> does:<a class="headerlink" href="#predict-sth-x-fh-does" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">X1</span> <span class="pre">=</span> <span class="pre">t1.transform(X)</span></code><br />
<code class="docutils literal notranslate"><span class="pre">X2</span> <span class="pre">=</span> <span class="pre">t2.transform(X1)</span></code><br />
etc<br />
<code class="docutils literal notranslate"><span class="pre">X[n]</span> <span class="pre">=</span> <span class="pre">t3.transform(X[n-1])</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">f.predict_[sth](X=X[n],</span> <span class="pre">fh)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_macroeconomic</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecastingPipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.split</span><span class="w"> </span><span class="kn">import</span> <span class="n">temporal_train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">Imputer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">load_macroeconomic</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;unemp&quot;</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;unemp&quot;</span><span class="p">])</span>

<span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">temporal_train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecastingPipeline</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">Imputer</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;forecaster&quot;</span><span class="p">,</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_test</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">unemp</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
    <tr>
      <th>Period</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1997Q1</th>
      <td>5.042704</td>
      <td>6.119990</td>
    </tr>
    <tr>
      <th>1997Q2</th>
      <td>3.948564</td>
      <td>5.235163</td>
    </tr>
    <tr>
      <th>1997Q3</th>
      <td>3.887471</td>
      <td>5.253592</td>
    </tr>
    <tr>
      <th>1997Q4</th>
      <td>4.108211</td>
      <td>5.506862</td>
    </tr>
    <tr>
      <th>1998Q1</th>
      <td>4.501319</td>
      <td>5.913611</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">TransformedTargetForecaster</span></code> takes a chain of transformers and forecasters, say,</p>
<p><code class="docutils literal notranslate"><span class="pre">[t1,</span> <span class="pre">t2,</span> <span class="pre">...,</span> <span class="pre">tn,</span> <span class="pre">f,</span> <span class="pre">tp1,</span> <span class="pre">tp2,</span> <span class="pre">...,</span> <span class="pre">tk]</span></code>,</p>
<p>where <code class="docutils literal notranslate"><span class="pre">t[i]</span></code> are forecasters that pre-process, and <code class="docutils literal notranslate"><span class="pre">tp[i]</span></code> are forecasters that postprocess</p>
</section>
<section id="id2">
<h4><code class="docutils literal notranslate"><span class="pre">fit(y,</span> <span class="pre">X,</span> <span class="pre">fh)</span></code> does:\<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">y1</span> <span class="pre">=</span> <span class="pre">t1.fit_transform(y)</span></code><br />
<code class="docutils literal notranslate"><span class="pre">y2</span> <span class="pre">=</span> <span class="pre">t2.fit_transform(y1)</span></code><br />
<code class="docutils literal notranslate"><span class="pre">y3</span> <span class="pre">=</span> <span class="pre">t3.fit_transform(y2)</span></code><br />
etc<br />
<code class="docutils literal notranslate"><span class="pre">y[n]</span> <span class="pre">=</span> <span class="pre">t3.fit_transform(y[n-1])</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">f.fit(y[n])</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">yp1</span> <span class="pre">=</span> <span class="pre">tp1.fit_transform(yn)</span></code><br />
<code class="docutils literal notranslate"><span class="pre">yp2</span> <span class="pre">=</span> <span class="pre">tp2.fit_transform(yp1)</span></code><br />
<code class="docutils literal notranslate"><span class="pre">yp3</span> <span class="pre">=</span> <span class="pre">tp3.fit_transform(yp2)</span></code><br />
etc</p>
</section>
<section id="predict-quantiles-y-x-fh-does">
<h4><code class="docutils literal notranslate"><span class="pre">predict_quantiles(y,</span> <span class="pre">X,</span> <span class="pre">fh)</span></code> does:<a class="headerlink" href="#predict-quantiles-y-x-fh-does" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">y1</span> <span class="pre">=</span> <span class="pre">t1.transform(y)</span></code><br />
<code class="docutils literal notranslate"><span class="pre">y2</span> <span class="pre">=</span> <span class="pre">t2.transform(y1)</span></code><br />
etc<br />
<code class="docutils literal notranslate"><span class="pre">y[n]</span> <span class="pre">=</span> <span class="pre">t3.transform(y[n-1])</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">y_pred</span> <span class="pre">=</span> <span class="pre">f.predict_quantiles(y[n])</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">y_pred</span> <span class="pre">=</span> <span class="pre">t[n].inverse_transform(y_pred)</span></code><br />
<code class="docutils literal notranslate"><span class="pre">y_pred</span> <span class="pre">=</span> <span class="pre">t[n-1].inverse_transform(y_pred)</span></code><br />
etc<br />
<code class="docutils literal notranslate"><span class="pre">y_pred</span> <span class="pre">=</span> <span class="pre">t1.inverse_transform(y_pred)</span></code><br />
<code class="docutils literal notranslate"><span class="pre">y_pred</span> <span class="pre">=</span> <span class="pre">tp1.transform(y_pred)</span></code><br />
<code class="docutils literal notranslate"><span class="pre">y_pred</span> <span class="pre">=</span> <span class="pre">tp2.transform(y_pred)</span></code><br />
etc<br />
<code class="docutils literal notranslate"><span class="pre">y_pred</span> <span class="pre">=</span> <span class="pre">tp[n].transform(y_pred)</span></code>\</p>
<p><strong>Note</strong>: the remaining proba predictions are inferred from <code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_macroeconomic</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.arima</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransformedTargetForecaster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.transformations.series.detrend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Deseasonalizer</span><span class="p">,</span> <span class="n">Detrender</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">load_macroeconomic</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;unemp&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">TransformedTargetForecaster</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;deseasonalize&quot;</span><span class="p">,</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;detrend&quot;</span><span class="p">,</span> <span class="n">Detrender</span><span class="p">()),</span>
        <span class="p">(</span><span class="s2">&quot;forecast&quot;</span><span class="p">,</span> <span class="n">ARIMA</span><span class="p">()),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">unemp</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009Q4</th>
      <td>8.949103</td>
      <td>10.068284</td>
    </tr>
    <tr>
      <th>2010Q1</th>
      <td>8.639806</td>
      <td>10.206350</td>
    </tr>
    <tr>
      <th>2010Q2</th>
      <td>8.438112</td>
      <td>10.337207</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span><span class="o">.</span><span class="n">predict_quantiles</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">unemp</th>
    </tr>
    <tr>
      <th></th>
      <th>0.05</th>
      <th>0.95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009Q4</th>
      <td>8.949103</td>
      <td>10.068284</td>
    </tr>
    <tr>
      <th>2010Q1</th>
      <td>8.639806</td>
      <td>10.206350</td>
    </tr>
    <tr>
      <th>2010Q2</th>
      <td>8.438112</td>
      <td>10.337207</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>quick creation also possible via the <code class="docutils literal notranslate"><span class="pre">*</span></code> dunder method, same pipeline:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">Deseasonalizer</span><span class="p">(</span><span class="n">sp</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">Detrender</span><span class="p">()</span> <span class="o">*</span> <span class="n">ARIMA</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">unemp</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="2" halign="left">0.9</th>
    </tr>
    <tr>
      <th></th>
      <th>lower</th>
      <th>upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2009Q4</th>
      <td>8.949103</td>
      <td>10.068284</td>
    </tr>
    <tr>
      <th>2010Q1</th>
      <td>8.639806</td>
      <td>10.206350</td>
    </tr>
    <tr>
      <th>2010Q2</th>
      <td>8.438112</td>
      <td>10.337207</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="building-your-own-probabilistic-forecaster">
<h2>Building your own probabilistic forecaster<a class="headerlink" href="#building-your-own-probabilistic-forecaster" title="Link to this heading">#</a></h2>
<p>Getting started:</p>
<ul class="simple">
<li><p>follow the <a class="reference external" href="https://www.sktime.net/en/stable/developer_guide/add_estimators.html">“implementing estimator” developer guide</a></p></li>
<li><p>use the advanced <a class="reference external" href="https://github.com/sktime/sktime/blob/main/extension_templates/forecasting.py">forecasting extension template</a></p></li>
</ul>
<p>Extension template = python “fill-in” template with to-do blocks that allow you to implement your own, sktime-compatible forecasting algorithm.</p>
<p>Check estimators using <code class="docutils literal notranslate"><span class="pre">check_estimator</span></code></p>
<p>For probabilistic forecasting:</p>
<ul class="simple">
<li><p>implement at least one of <code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code>, <code class="docutils literal notranslate"><span class="pre">predict_interval</span></code>, <code class="docutils literal notranslate"><span class="pre">predict_var</span></code>, <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code></p></li>
<li><p>optimally, implement all, unless identical with defaulting behaviour as below</p></li>
<li><p>if only one is implemented, others use following defaults (in this sequence, dependent availability):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> uses quantiles from <code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> and vice versa</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_var</span></code> uses variance from <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code>, or variance of normal with IQR as obtained from <code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> uses quantiles from <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> distribution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> returns normal with mean <code class="docutils literal notranslate"><span class="pre">predict</span></code> and variance <code class="docutils literal notranslate"><span class="pre">predict_var</span></code></p></li>
</ul>
</li>
<li><p>so if predictive residuals not normal, implement <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code></p></li>
<li><p>if interfacing, implement the ones where least “conversion” is necessary</p></li>
<li><p>ensure to set the <code class="docutils literal notranslate"><span class="pre">capability:pred_int</span></code> tag to <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># estimator checking on the fly using check_estimator</span>

<span class="c1"># suppose NaiveForecaster is your new estimator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.forecasting.naive</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveForecaster</span>

<span class="c1"># check the estimator like this</span>

<span class="c1"># uncomment this block to run</span>

<span class="c1"># from sktime.utils.estimator_checks import check_estimator</span>
<span class="c1">#</span>
<span class="c1"># check_estimator(NaiveForecaster)</span>

<span class="c1"># this prints any failed tests, and returns dictionary with</span>
<span class="c1">#   keys of test runs and results from the test run</span>
<span class="c1"># run individual tests using the tests_to_run arg or the fixtures_to_run_arg</span>
<span class="c1">#   these need to be identical to test or test/fixture names, see docstring</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to raise errors for use in traceback debugging:</span>

<span class="c1"># uncomment next line to run</span>
<span class="c1"># check_estimator(NaiveForecaster, raise_exceptions=True)</span>

<span class="c1"># this does not raise an error since NaiveForecaster is fine, but would if it weren&#39;t</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>unified API for probabilistic forecasting and probabilistic metrics</p></li>
<li><p>integrating other packages (e.g. scikit-learn, statsmodels, pmdarima, prophet)</p></li>
<li><p>interface for composite model building is same, proba or not (pipelining, ensembling, tuning, reduction)</p></li>
<li><p>easily extensible with custom estimators</p></li>
</ul>
<section id="useful-resources">
<h3>Useful resources<a class="headerlink" href="#useful-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>For more details, take a look at <a class="reference external" href="https://arxiv.org/abs/2005.08067">our paper on forecasting with sktime</a> in which we discuss the forecasting API in more detail and use it to replicate and extend the M4 study.</p></li>
<li><p>For a good introduction to forecasting, see <a class="reference external" href="https://otexts.com/fpp2/">Hyndman, Rob J., and George Athanasopoulos. Forecasting: principles and practice. OTexts, 2018</a>.</p></li>
<li><p>For comparative benchmarking studies/forecasting competitions, see the <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0169207019301128">M4 competition</a> and the <a class="reference external" href="https://www.kaggle.com/c/m5-forecasting-accuracy/overview">M5 competition</a>.</p></li>
</ul>
</section>
<section id="credits">
<h3>Credits<a class="headerlink" href="#credits" title="Link to this heading">#</a></h3>
<p>notebook creation: fkiraly</p>
<p>probabilistic forecasting framework: fkiraly, kejsitake<br />
probabilistic metrics, tuning: eenticott-shell, fkiraly<br />
probabilistic estimators: aiwalter, fkiraly, ilyasmoutawwakil, k1m190r, kejsitake</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./.venv\Lib\site-packages\docs\source\examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Probabilistic Forecasting with <code class="docutils literal notranslate"><span class="pre">sktime</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-this-notebook">Overview of this notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-start-probabilistic-forecasting-with-sktime">Quick Start - Probabilistic Forecasting with <code class="docutils literal notranslate"><span class="pre">sktime</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-probabilistic-forecasting">What is probabilistic forecasting?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intuition">Intuition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interface-view">Interface view</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formal-view-endogeneous-one-forecast-time-stamp">Formal view (endogeneous, one forecast time stamp)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#more-formal-details-intuition">More formal details &amp; intuition:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilistic-forecasting-interfaces-in-sktime">Probabilistic forecasting interfaces in <code class="docutils literal notranslate"><span class="pre">sktime</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-interval-interval-predictions"><code class="docutils literal notranslate"><span class="pre">predict_interval</span></code> - interval predictions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-quantiles-quantile-forecasts"><code class="docutils literal notranslate"><span class="pre">predict_quantiles</span></code> - quantile forecasts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-var-variance-forecasts"><code class="docutils literal notranslate"><span class="pre">predict_var</span></code> - variance forecasts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-proba-distribution-forecasts-aka-full-probabilistic-forecasts"><code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> - distribution forecasts aka “full” probabilistic forecasts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-note-on-consistence-of-methods">a note on consistence of methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-probabilistic-forecasts-with-update-predict-stream-workflow">Using probabilistic forecasts with update/predict stream workflow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilistic-forecasting-for-multivariate-and-hierarchical-data">Probabilistic forecasting for multivariate and hierarchical data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics-for-probabilistic-forecasts-and-evaluation">Metrics for probabilistic forecasts and evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-theory">overview - theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics-general-signature-and-averaging">metrics: general signature and averaging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics-interval-vs-quantile-metrics">metrics: interval vs quantile metrics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation-by-backtesting">evaluation by backtesting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-evaluation">Visual Evaluation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-composition-pipelines-tuning-reduction-adding-proba-forecasts-to-any-estimator">Advanced composition: pipelines, tuning, reduction, adding proba forecasts to any estimator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-probabilistic-forecasts-to-non-probabilistic-forecasters">Adding probabilistic forecasts to non-probabilistic forecasters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-and-automl">Tuning and AutoML</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines-with-probabilistic-forecasters">Pipelines with probabilistic forecasters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-y-x-fh-does"><code class="docutils literal notranslate"><span class="pre">fit(y,</span> <span class="pre">X,</span> <span class="pre">fh)</span></code> does:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-sth-x-fh-does"><code class="docutils literal notranslate"><span class="pre">predict_[sth](X,</span> <span class="pre">fh)</span></code> does:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><code class="docutils literal notranslate"><span class="pre">fit(y,</span> <span class="pre">X,</span> <span class="pre">fh)</span></code> does:\</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-quantiles-y-x-fh-does"><code class="docutils literal notranslate"><span class="pre">predict_quantiles(y,</span> <span class="pre">X,</span> <span class="pre">fh)</span></code> does:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-your-own-probabilistic-forecaster">Building your own probabilistic forecaster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-resources">Useful resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>