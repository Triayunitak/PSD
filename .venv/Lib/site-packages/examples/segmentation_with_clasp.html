
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Time Series Segmentation with sktime and ClaSP &#8212; PSD</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '.venv/Lib/site-packages/examples/segmentation_with_clasp';</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/nita.png" class="logo__image only-light" alt="PSD - Home"/>
    <script>document.write(`<img src="../../../../_static/nita.png" class="logo__image only-dark" alt="PSD - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../business_understanding.html"><strong>Business Problem</strong></a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../data_understanding.html"><strong>Data Understanding</strong></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../data_exploration.html"><strong>Data Exploration</strong></a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../data_preprocessing.html"><strong>PrepocessingData</strong></a></li>






<li class="toctree-l1"><a class="reference internal" href="../../../../e_coli.html"><strong>E. coli Protein PCA &amp; ADASYN Implementation</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F.venv/Lib/site-packages/examples/segmentation_with_clasp.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/.venv/Lib/site-packages/examples/segmentation_with_clasp.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Time Series Segmentation with sktime and ClaSP</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Time Series Segmentation with sktime and ClaSP</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-task-of-time-series-segmentation">The Task of Time Series Segmentation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-segmentation-through-clasp">Time Series Segmentation through ClaSP</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-the-data">Retrieve the data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clasp-classification-score-profile">ClaSP - Classification Score Profile</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-of-segmentation">Visualization of segmentation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#output-formats">Output formats</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clasp-window-size-selection">ClaSP - Window Size Selection</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="time-series-segmentation-with-sktime-and-clasp">
<h1>Time Series Segmentation with sktime and ClaSP<a class="headerlink" href="#time-series-segmentation-with-sktime-and-clasp" title="Link to this heading">#</a></h1>
<p>In this notebook, we will showcase <code class="docutils literal notranslate"><span class="pre">sktime</span></code> and <code class="docutils literal notranslate"><span class="pre">ClaSP</span></code> for the task of time series segmentation. We will first give an introduction to the task of time series segmentation, illustrate the ease of use of ClaSP, and present the found segmentation for a show case.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-task-of-time-series-segmentation">
<h1>The Task of Time Series Segmentation<a class="headerlink" href="#the-task-of-time-series-segmentation" title="Link to this heading">#</a></h1>
<p>A particularly interesting problem which we will study in this notebook is time series segmentation (TSS).</p>
<p>TSS aims at discovering regions of a time series that are semantically dissimilar to neighboring regions. TSS is an important technology, as it allows to infer properties of the underlying system by analysis of the measurements, because shifts from one segment to another are often caused by state changes in the process being monitored, such as a transition from one operational state to another or the onset of an unusual event. Change point detection (CPD) is the task of finding such shifts in the underlying signal, and a segmentation is an ordered sequence of change points.</p>
<p>The following image shows two examples of (a) heartbeats recorded from a patient with different medical conditions, and (b) a person walking, jogging and running. The time series contain three visually very distinct segments, which we also denoted by colors and annotated by the underlying state.
<img src="./img/segmentation_use_cases.png" width="400" alt="use-cases"></p>
<p>The task of any TSS algorithm is to find these segments.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="prerequisites">
<h1>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_color_codes</span><span class="p">()</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.annotation.clasp</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClaSPSegmentation</span><span class="p">,</span> <span class="n">find_dominant_window_sizes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.annotation.plotting.utils</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">plot_time_series_with_change_points</span><span class="p">,</span>
    <span class="n">plot_time_series_with_profiles</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sktime.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_electric_devices_segmentation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">()</span>

<span class="n">File</span> <span class="n">D</span><span class="p">:</span>\<span class="n">masterprog</span>\<span class="n">XAMPP</span>\<span class="n">htdocs</span>\<span class="n">PSD</span>\<span class="n">tugas1</span><span class="o">-</span><span class="n">proyek</span><span class="o">-</span><span class="n">datasains</span>\<span class="o">.</span><span class="n">venv</span>\<span class="n">Lib</span>\<span class="n">site</span><span class="o">-</span><span class="n">packages</span>\<span class="n">examples</span>\<span class="o">..</span>\<span class="n">pandas</span>\<span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">29</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span>         <span class="n">_missing_dependencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_dependency</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">_e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span> <span class="k">if</span> <span class="n">_missing_dependencies</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<span class="ne">---&gt; </span><span class="mi">29</span>     <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span>         <span class="s2">&quot;Unable to import required dependencies:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_missing_dependencies</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span>     <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span> <span class="k">del</span> <span class="n">_hard_dependencies</span><span class="p">,</span> <span class="n">_dependency</span><span class="p">,</span> <span class="n">_missing_dependencies</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span>     <span class="c1"># numpy compat</span>

<span class="ne">ImportError</span>: Unable to import required dependencies:
<span class="ne">numpy</span>: Error importing numpy: you should not try to import numpy from
        <span class="n">its</span> <span class="n">source</span> <span class="n">directory</span><span class="p">;</span> <span class="n">please</span> <span class="n">exit</span> <span class="n">the</span> <span class="n">numpy</span> <span class="n">source</span> <span class="n">tree</span><span class="p">,</span> <span class="ow">and</span> <span class="n">relaunch</span>
        <span class="n">your</span> <span class="n">python</span> <span class="n">interpreter</span> <span class="kn">from</span><span class="w"> </span><span class="nn">there.</span>
</pre></div>
</div>
</div>
</div>
<p>The following use case shows an energy profile of electric household devices with four change points indicating different operational states or plugged household devices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span><span class="p">,</span> <span class="n">period_size</span><span class="p">,</span> <span class="n">true_cps</span> <span class="o">=</span> <span class="n">load_electric_devices_segmentation</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plot_time_series_with_change_points</span><span class="p">(</span><span class="s2">&quot;Electric Devices&quot;</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">true_cps</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/f10763b8b38bd29781dd9b948c8a1420e78c832e0588b77bb65659d23f2f0151.png" src="../../../../_images/f10763b8b38bd29781dd9b948c8a1420e78c832e0588b77bb65659d23f2f0151.png" />
</div>
</div>
<p>The annotated change points are around time stamps <span class="math notranslate nohighlight">\([1090,4436,5712,7923]\)</span>, from which different electric devices are recorded.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="time-series-segmentation-through-clasp">
<h1>Time Series Segmentation through ClaSP<a class="headerlink" href="#time-series-segmentation-through-clasp" title="Link to this heading">#</a></h1>
<p>This Jupyter-Notebook illustrates the usage of the <em>Classification Score Profile (ClaSP)</em> for time series segmentation.</p>
<p>ClaSP hierarchically splits a TS into two parts, where each split point is determined by training a binary TS classifier for each possible split point and selecting the one with highest accuracy, i.e., the one that is best at identifying subsequences to be from either of the partitions.</p>
<p>Please refer to our paper, published at CIKM ‘21, for details:
<em>P. Schäfer, A. Ermshaus, U. Leser, ClaSP - Time Series Segmentation, CIKM 2021</em></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="retrieve-the-data">
<h1>Retrieve the data<a class="headerlink" href="#retrieve-the-data" title="Link to this heading">#</a></h1>
<p>First lets look at and plot the time series to be segmented.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ts is a pd.Series</span>
<span class="c1"># we convert it into a DataFrame for display purposed only</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
    <tr>
      <th>0</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>-0.187086</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.098119</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.088967</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.107328</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.193514</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>11528</th>
      <td>0.300240</td>
    </tr>
    <tr>
      <th>11529</th>
      <td>0.200745</td>
    </tr>
    <tr>
      <th>11530</th>
      <td>-0.548908</td>
    </tr>
    <tr>
      <th>11531</th>
      <td>0.274886</td>
    </tr>
    <tr>
      <th>11532</th>
      <td>0.274022</td>
    </tr>
  </tbody>
</table>
<p>11532 rows × 1 columns</p>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="clasp-classification-score-profile">
<h1>ClaSP - Classification Score Profile<a class="headerlink" href="#clasp-classification-score-profile" title="Link to this heading">#</a></h1>
<p>Let’s run ClaSP to find the true change point.</p>
<p>ClaSP has two hyper-parameters:</p>
<ul class="simple">
<li><p>The period length</p></li>
<li><p>The number of change points to find</p></li>
</ul>
<p>The result of ClaSP is a profile in which the maximum indicates the found change points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clasp</span> <span class="o">=</span> <span class="n">ClaSPSegmentation</span><span class="p">(</span><span class="n">period_length</span><span class="o">=</span><span class="n">period_size</span><span class="p">,</span> <span class="n">n_cps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;sparse&quot;</span><span class="p">)</span>
<span class="n">found_cps</span> <span class="o">=</span> <span class="n">clasp</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">profiles</span> <span class="o">=</span> <span class="n">clasp</span><span class="o">.</span><span class="n">profiles</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">clasp</span><span class="o">.</span><span class="n">scores</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The found change points are&quot;</span><span class="p">,</span> <span class="n">found_cps</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The found change points are [1038 4525 5719 7883]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="visualization-of-segmentation">
<h1>Visualization of segmentation<a class="headerlink" href="#visualization-of-segmentation" title="Link to this heading">#</a></h1>
<p>… and we visualize the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_time_series_with_profiles</span><span class="p">(</span>
    <span class="s2">&quot;Electric Devices&quot;</span><span class="p">,</span>
    <span class="n">ts</span><span class="p">,</span>
    <span class="n">profiles</span><span class="p">,</span>
    <span class="n">true_cps</span><span class="p">,</span>
    <span class="n">found_cps</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/88340c748a5cc27dd96ec0c0e5f7a7ca81ca71b8be5784009bc107360ee0765a.png" src="../../../../_images/88340c748a5cc27dd96ec0c0e5f7a7ca81ca71b8be5784009bc107360ee0765a.png" />
</div>
</div>
<p>The predicted change points in green closely resembles the true change points in red.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="output-formats">
<h1>Output formats<a class="headerlink" href="#output-formats" title="Link to this heading">#</a></h1>
<p>ClaSP provides two different output formats given the <code class="docutils literal notranslate"><span class="pre">fmt</span></code> input parameter:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fmt:&quot;sparse&quot;</span></code>: provides the core change points</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fmt:&quot;dense&quot;</span></code>: provides an interval series giving the segmentation</p></li>
</ul>
<p>We have seen the output of <code class="docutils literal notranslate"><span class="pre">fmt=&quot;sparse&quot;</span></code> before. This time we return <code class="docutils literal notranslate"><span class="pre">fmt=&quot;dense&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clasp</span> <span class="o">=</span> <span class="n">ClaSPSegmentation</span><span class="p">(</span><span class="n">period_length</span><span class="o">=</span><span class="n">period_size</span><span class="p">,</span> <span class="n">n_cps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)</span>
<span class="n">found_segmentation</span> <span class="o">=</span> <span class="n">clasp</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">found_segmentation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IntervalIndex([(0, 1038], (1038, 4525], (4525, 5719], (5719, 7883], (7883, 11532]],
              closed=&#39;right&#39;,
              dtype=&#39;interval[int64]&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="clasp-window-size-selection">
<h1>ClaSP - Window Size Selection<a class="headerlink" href="#clasp-window-size-selection" title="Link to this heading">#</a></h1>
<p>ClaSP takes the window size 𝑤 as a hyper-parameter. This parameter has data-dependent effects on ClaSP’s performance. When chosen too small, all windows tend to appear similar; when chosen too large, windows have a higher chance to overlap adjacent segments, blurring their discriminative power.</p>
<p>A simple, yet effective method for choosing the window size is the dominant frequency of the Fourier Transform.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dominant_period_size</span> <span class="o">=</span> <span class="n">find_dominant_window_sizes</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dominant Period&quot;</span><span class="p">,</span> <span class="n">dominant_period_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dominant Period 10
</pre></div>
</div>
</div>
</div>
<p>Let us run ClaSP with the found dominant period length.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clasp</span> <span class="o">=</span> <span class="n">ClaSPSegmentation</span><span class="p">(</span><span class="n">period_length</span><span class="o">=</span><span class="n">dominant_period_size</span><span class="p">,</span> <span class="n">n_cps</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">found_cps</span> <span class="o">=</span> <span class="n">clasp</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">profiles</span> <span class="o">=</span> <span class="n">clasp</span><span class="o">.</span><span class="n">profiles</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">clasp</span><span class="o">.</span><span class="n">scores</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plot_time_series_with_profiles</span><span class="p">(</span>
    <span class="s2">&quot;ElectricDevices&quot;</span><span class="p">,</span>
    <span class="n">ts</span><span class="p">,</span>
    <span class="n">profiles</span><span class="p">,</span>
    <span class="n">true_cps</span><span class="p">,</span>
    <span class="n">found_cps</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/a1b2bded6e22c3a934eb87cb2aa15df8db08a0e36b0b53387c1a5ad1bc2b7a67.png" src="../../../../_images/a1b2bded6e22c3a934eb87cb2aa15df8db08a0e36b0b53387c1a5ad1bc2b7a67.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./.venv\Lib\site-packages\examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Time Series Segmentation with sktime and ClaSP</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-task-of-time-series-segmentation">The Task of Time Series Segmentation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-segmentation-through-clasp">Time Series Segmentation through ClaSP</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-the-data">Retrieve the data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clasp-classification-score-profile">ClaSP - Classification Score Profile</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-of-segmentation">Visualization of segmentation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#output-formats">Output formats</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clasp-window-size-selection">ClaSP - Window Size Selection</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>